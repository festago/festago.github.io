{"componentChunkName":"component---src-templates-post-jsx","path":"/oauth2-multiple-user-auth/","result":{"data":{"site":{"siteMetadata":{"title":"Festago"}},"markdownRemark":{"id":"1c28c731-cebd-5aab-b9bd-a5c397bf9c7a","excerpt":"ì„œë¡  ì•ˆë…•í•˜ì„¸ìš”. í˜ìŠ¤íƒ€ê³ ì˜ ê¸€ë Œì…ë‹ˆë‹¤. ğŸ¥ƒ í˜ìŠ¤íƒ€ê³ ì—ëŠ” ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìê°€ ìˆë‹¤ë©´ ì‚¬ìš©ìì˜ ì—­í• ì— ë§ëŠ” ì¸ì¦ê³¼ ì¸ê°€ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¨ìˆœíˆ ì—­í• ì— ë”°ë¥¸ êµ¬ë¶„ì´ë¼ë©´ í° ë¬¸ì œê°€ ì—†ê² ì§€ë§Œ, ë‹¤ì–‘í•œ ì‚¬ìš©ìë“¤ì´ ì ‘ì†í•˜ëŠ” í™˜ê²½ì—ì„œ ì¸ì¦ì„ í•˜ëŠ” ë°©ë²•ì—ì„œ ì°¨ì´ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì–´ë– í•œ ë¬¸ì œì ì— ì§ë©´í–ˆê³ , ì´â€¦","html":"<h2>ì„œë¡ </h2>\n<p>ì•ˆë…•í•˜ì„¸ìš”.</p>\n<p>í˜ìŠ¤íƒ€ê³ ì˜ ê¸€ë Œì…ë‹ˆë‹¤. ğŸ¥ƒ</p>\n<p>í˜ìŠ¤íƒ€ê³ ì—ëŠ” ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<p>ì´ë ‡ê²Œ ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìê°€ ìˆë‹¤ë©´ ì‚¬ìš©ìì˜ ì—­í• ì— ë§ëŠ” ì¸ì¦ê³¼ ì¸ê°€ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<p>ë‹¨ìˆœíˆ ì—­í• ì— ë”°ë¥¸ êµ¬ë¶„ì´ë¼ë©´ í° ë¬¸ì œê°€ ì—†ê² ì§€ë§Œ, ë‹¤ì–‘í•œ ì‚¬ìš©ìë“¤ì´ ì ‘ì†í•˜ëŠ” í™˜ê²½ì—ì„œ ì¸ì¦ì„ í•˜ëŠ” ë°©ë²•ì—ì„œ ì°¨ì´ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>\n<p>ì–´ë– í•œ ë¬¸ì œì ì— ì§ë©´í–ˆê³ , ì´ê²ƒì„ ì–´ë–»ê²Œ í•´ê²°í–ˆëŠ”ì§€ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<h2>ë³¸ë¡ </h2>\n<p>í˜ìŠ¤íƒ€ê³ ëŠ” ì¶•ì œì˜ ê³µì—°ì— ëŒ€í•œ í‹°ì¼“íŒ…ì„ ì˜¤í”„ë¼ì¸ìœ¼ë¡œ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì˜¨ë¼ì¸ìœ¼ë¡œ í¸í•˜ê²Œ ì˜ˆë§¤í•˜ê³  ë¹ ë¥´ê²Œ ì¶œì…ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</p>\n<p>ì ê¹ ì €í¬ ì„œë¹„ìŠ¤ì˜ íë¦„ì— ê´€í•´ ì´ì•¼ê¸°ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<p>ì‚¬ìš©ìê°€ ê³µì—°ì— ëŒ€í•´ í‹°ì¼“ì„ ì˜ˆë§¤í•˜ë ¤ê³  í•©ë‹ˆë‹¤.</p>\n<p>ì´ë•Œ, ì‚¬ìš©ìê°€ í‹°ì¼“ì„ ì˜ˆë§¤í•˜ë ¤ë©´ ìš°ì„  ê³µì—°ê³¼ ì¶•ì œê°€ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ê·¸ë ‡ë‹¤ë©´ ê³µì—°ê³¼ ì¶•ì œëŠ” í‹°ì¼“ì„ ì˜ˆë§¤í•˜ëŠ” ì‚¬ìš©ìê°€ ìƒì„±ì„ í•˜ëŠ” ê²ƒì¼ê¹Œìš”?</p>\n<p>ê³µì—°ê³¼ ì¶•ì œë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì€ í‹°ì¼“ì„ ì˜ˆë§¤í•˜ëŠ” ì‚¬ìš©ìê°€ ì•„ë‹Œ, ì¶•ì œì™€ ê³µì—°ì„ ê°œìµœí•˜ê³  ì‹¶ì€ ê´€ë¦¬ìì…ë‹ˆë‹¤.</p>\n<p>ê·¸ë¦¬ê³  ì˜ˆë§¤í•œ í‹°ì¼“ì„ ê²€ì‚¬í•  ë•Œë„ ë§ˆì°¬ê°€ì§€ë¡œ, í‹°ì¼“ì„ ê²€ì‚¬í•˜ëŠ” ì‚¬ìš©ìê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í‹°ì¼“ì„ ê²€ì‚¬í•˜ëŠ” ì‚¬ìš©ìëŠ” ê³µì—°ê³¼ ì¶•ì œë¥¼ ìƒì„±í•˜ëŠ” ê´€ë¦¬ìê°€ ì•„ë‹Œ, ê´€ë¦¬ìì— ì˜í•´ ê³ ìš©ëœ ìŠ¤íƒœí”„ì¼ ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ì´ì²˜ëŸ¼ í˜ìŠ¤íƒ€ê³ ì—ëŠ” ì—­í• ë³„ë¡œ ì±…ì„ì´ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<blockquote>\n<p>í‹°ì¼“ì„ ì˜ˆë§¤í•˜ê³  ì‹¶ì€ ì‚¬ìš©ì -> Member</p>\n<p>ì¶•ì œì™€ ê³µì—°ì„ ê³„íší•˜ê³  ê°œìµœí•˜ê³  ì‹¶ì€ ì‚¬ìš©ì -> Admin</p>\n<p>í‹°ì¼“ì„ ê²€ì‚¬í•˜ê³  ì‹¶ì€ ì‚¬ìš©ì -> Staff</p>\n</blockquote>\n<p>ì´ë ‡ë“¯ ì‚¬ìš©ìë“¤ì€ ê°ìì˜ ì—­í• ê³¼ ì±…ì„ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ°ë° ì–´ë–»ê²Œ ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<p>ì €í¬ ì„œë¹„ìŠ¤ëŠ” JWT í† í°ì„ ê¸°ë°˜ìœ¼ë¡œ ì¸ì¦ì„ ìˆ˜í–‰í•˜ë‹ˆ JWT í† í°ì— ë‹¤ìŒê³¼ ê°™ì€ ê°’ì„ ë„£ì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"role\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MEMBER\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"role\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"STAFF\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"role\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ADMIN\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ë ‡ê²Œ í† í°ì— <code class=\"language-text\">role</code> í•„ë“œë¥¼ ì¶”ê°€í•˜ë©´ ì‚¬ìš©ìì˜ ì—­í• ì„ ì‰½ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p>ê° ì—­í• ì˜ ì‚¬ìš©ìë“¤ì€ ì ‘ì†í•˜ëŠ” í™˜ê²½ì´ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ì¼ë°˜ ì‚¬ìš©ìì™€ ìŠ¤íƒœí”„ëŠ” ëª¨ë°”ì¼ ì•± í™˜ê²½ì—ì„œ ì €í¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ê´€ë¦¬ìëŠ” ëª¨ë°”ì¼ ì•±ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ì›¹ í˜ì´ì§€ë¥¼ í†µí•´ ì €í¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>\n<p>ê´€ë¦¬ìê°€ ì ‘ì†í•˜ëŠ” í™˜ê²½ì—ì„œëŠ” ì „ìš© ì•±ì„ ì œì‘í•  í•„ìš”ê°€ ì—†ê³  ê°„ë‹¨í•œ ì›¹ í˜ì´ì§€ë§Œ ìˆìœ¼ë©´ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ°ë° ì´ê²ƒì´ ì™œ ë¬¸ì œê°€ ë˜ëŠ” ê±¸ê¹Œìš”?</p>\n<p>ëª¨ë°”ì¼ ì•± í™˜ê²½ì—ì„œ ìš”ì²­ì„ ë³´ë‚¼ ë•ŒëŠ” JWT í† í°ì„ HTTP í—¤ë”ì— ë‹´ì•„ ìš”ì²­í•©ë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ì›¹ í˜ì´ì§€ í™˜ê²½ì—ì„œëŠ” JWT í† í°ì„ ì¿ í‚¤ì— ë‹´ì•„ ìš”ì²­í•©ë‹ˆë‹¤.</p>\n<p>ì´ë ‡ê²Œ ì‚¬ìš©ìì˜ í™˜ê²½ë§ˆë‹¤ í† í°ì„ ë³´ë‚´ëŠ” ë°©ë²•ì´ ë‹¤ë¥´ë‹ˆ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p>ì—¬ê¸°ì„œ ì´ëŸ° ìƒê°ì´ ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>\"ì›¹ í˜ì´ì§€ì—ì„œë„ í—¤ë”ì— í† í°ì„ ë‹´ì•„ì„œ ë³´ë‚´ë©´ ì•ˆë˜ë‚˜ìš”?\"</p>\n</blockquote>\n<p>ì›¹ í˜ì´ì§€ë¥¼ í†µí•´ í† í°ì„ í—¤ë”ì— ë‹´ì•„ ìš”ì²­ì„ í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p>ë‹¨ìˆœí•˜ê²Œ í† í°ì„ í—¤ë”ì— ë‹´ì•„ ìš”ì²­í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<ol>\n<li>ë¡œê·¸ì¸ì„ í†µí•´ tokenì„ ì„œë²„ì—ì„œ ì–»ëŠ”ë‹¤.</li>\n<li>tokenì„ ì–´ë”˜ê°€ì— ì €ì¥í•œë‹¤.</li>\n<li>ìš”ì²­ë§ˆë‹¤ ì €ì¥í•œ í† í°ì„ í—¤ë”ì— ì¶”ê°€í•˜ì—¬ ì„œë²„ì— ì „ì†¡í•œë‹¤.</li>\n</ol>\n<p>ì—¬ê¸°ì„œ tokenì„ ì–´ë”˜ê°€ì— ì €ì¥í•´ì•¼ í•˜ëŠ”ë°, ì €ì¥í•  ì¥ì†ŒëŠ” <code class=\"language-text\">LocalStorage</code> ë˜ëŠ” <code class=\"language-text\">SessionStorage</code>ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>\n<p>ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì´ <code class=\"language-text\">Authorization</code> í—¤ë”ë¥¼ ì¶”ê°€í•˜ì—¬ ìš”ì²­ì„ ë³´ë‚´ë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> credentials <span class=\"token operator\">=</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'credentials'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/function\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>  \n  <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>  \n  <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token string-property property\">\"Authorization\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>credentials<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/json\"</span>  \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>  \n  <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span>  \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì½”ë“œë§Œ ë³¸ë‹¤ë©´ ì €ì¥ëœ í† í°ì„ êº¼ë‚´ëŠ” ì‘ì—…ê³¼ í—¤ë”ì— í† í°ì„ ì¶”ê°€í•˜ëŠ” ì‘ì—… ì™¸ì—ëŠ” ì „í˜€ ë¬¸ì œê°€ ë  ìƒí™©ì´ë¼ê³  ë³´ì´ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ë³´ì•ˆ ì¸¡ë©´ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<p>LocalStorage ê°™ì€ ì €ì¥ì†Œì— ìˆëŠ” ê°’ë“¤ì€ XSS ê³µê²©ì— ì·¨ì•½í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ë‹¤ìŒê³¼ ê°™ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ ì €í¬ ì„œë¹„ìŠ¤ì—ì„œ ì œê³µëœ í† í°ì„ ì‰½ê²Œ íƒˆì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'credentials'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì¿ í‚¤ ë˜í•œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ ì‰½ê²Œ XSS ê³µê²©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<p>ë‹¤ìŒê³¼ ê°™ì€ í•œ ì¤„ë¡œ ì¿ í‚¤ì˜ ëª©ë¡ì„ ì „ë¶€ ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">document<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">;</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì¿ í‚¤ì˜ ê²½ìš° <code class=\"language-text\">HttpOnly</code>ë¼ëŠ” í”Œë˜ê·¸ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<p>í•´ë‹¹ í”Œë˜ê·¸ë¥¼ ì„¤ì •í•˜ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, LocalStorage ë³´ë‹¤ ì•ˆì „í•˜ê²Œ í† í°ì„ ë³´ê´€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë˜í•œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë§¤ ìš”ì²­ ì‹œ í† í°ì„ êº¼ë‚´ê³  í—¤ë”ì— ì¶”ê°€í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ê°œë°œì˜ í¸ì˜ì„± ë˜í•œ ë†’ìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ì´ëŸ¬í•œ ìƒí™©ìœ¼ë¡œ ì¸í•´ í—¤ë”ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì´ ì•„ë‹Œ, ì¿ í‚¤ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p>\n<hr>\n<h3>ê¸°ì¡´ì˜ ì¸ì¦ ë°©ì‹</h3>\n<p>ê¸°ì¡´ì˜ ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginMemberResolver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerMethodArgumentResolver</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">BEARER_TOKEN_PREFIX</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Bearer \"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AuthExtractor</span> authExtractor<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginMemberResolver</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthExtractor</span> authExtractor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authExtractor <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">supportsParameter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodParameter</span> parameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> parameter<span class=\"token punctuation\">.</span><span class=\"token function\">getParameterType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> parameter<span class=\"token punctuation\">.</span><span class=\"token function\">hasParameterAnnotation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Login</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginMember</span> <span class=\"token function\">resolveArgument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> header <span class=\"token operator\">=</span> webRequest<span class=\"token punctuation\">.</span><span class=\"token function\">getHeader</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTHORIZATION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> <span class=\"token function\">extractToken</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getMemberId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">extractToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> header<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">validateHeader</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> header<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BEARER_TOKEN_PREFIX</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">validateHeader</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> header<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>header <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>header<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BEARER_TOKEN_PREFIX</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ë•ŒëŠ” ì—­í• ì´ë¼ëŠ” ë„ë©”ì¸ì´ ì—†ê³  ë‹¨ìˆœíˆ ì‚¬ìš©ìì— ëŒ€í•œ ì¸ì¦ë§Œ ìˆì—ˆê¸° ë•Œë¬¸ì— <code class=\"language-text\">ArgumentResolver</code>ë¡œ ì¸ì¦ ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ì— <code class=\"language-text\">@Login</code> ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì´ë©´ í•´ë‹¹ í•¸ë“¤ëŸ¬ì— ì¸ì¦ ê¸°ëŠ¥ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/profile\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MemberProfileResponse</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">findMemberProfile</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Login</span> <span class=\"token class-name\">LoginMember</span> loginMember<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>ì¶”ê°€ëœ ê¸°ëŠ¥, ë°œìƒí•œ ë¬¸ì œì </h3>\n<p>ì§€ê¸ˆê¹Œì§€ ê´€ë¦¬ì ì›¹ í˜ì´ì§€ì— ì ‘ì†í•  ë•Œ ì¸ì¦, ì¸ê°€ ì‘ì—… ì—†ì´ ëˆ„êµ¬ë‚˜ ì ‘ì†ì´ ê°€ëŠ¥í–ˆê¸° ë•Œë¬¸ì— ê´€ë¦¬ìì— ëŒ€í•œ ì¸ì¦ê³¼ ì¸ê°€ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.</p>\n<p>ìœ„ì—ì„œ ì„¤ëª…í–ˆë“¯, ê´€ë¦¬ìì— ëŒ€í•œ ì¸ì¦ì€ í—¤ë”ê°€ ì•„ë‹Œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ê¸°ì¡´ì˜ ì¸ì¦ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” <code class=\"language-text\">LoginMemberResolver</code>ì—ëŠ” í—¤ë”ë¥¼ í†µí•œ ì¸ì¦ë§Œ ë˜ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginMemberResolver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerMethodArgumentResolver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginMember</span> <span class=\"token function\">resolveArgument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> header <span class=\"token operator\">=</span> webRequest<span class=\"token punctuation\">.</span><span class=\"token function\">getHeader</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTHORIZATION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> <span class=\"token function\">extractToken</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getMemberId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë”°ë¼ì„œ ê´€ë¦¬ìì˜ ì¸ì¦ì€ ê¸°ì¡´ì˜ <code class=\"language-text\">LoginMemberResolver</code>ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê³  ìƒˆë¡œìš´ <code class=\"language-text\">ArgumentResolver</code>ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginAdminResolver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerMethodArgumentResolver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginMember</span> <span class=\"token function\">resolveArgument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> cookies <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getCookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> <span class=\"token function\">extractToken</span><span class=\"token punctuation\">(</span>cookies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getRole</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ëŸ¬ë©´ ì´ì œ ê´€ë¦¬ì ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ <code class=\"language-text\">@LoginAdmin</code> ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê´€ë¦¬ìì— ëŒ€í•œ ì¸ì¦ê³¼ ì¸ê°€ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/festivals\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Void</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">createFestival</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Admin</span> <span class=\"token class-name\">LoginMember</span> loginMember<span class=\"token punctuation\">,</span>\n                                           <span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">FestivalCreateRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    festivalService<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ë ‡ê²Œ ì—¬ëŸ¬ ì‚¬ìš©ìì— ëŒ€í•œ ì¸ì¦ê³¼ ì¸ê°€ ì‘ì—…ì´ ëë‚¬ì„ê¹Œìš”..?</p>\n<p>ì•ˆíƒ€ê¹ê²Œë„ ì—¬ê¸°ì—ëŠ” ì—¬ëŸ¬ ë¬¸ì œì ì´ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<h4>í•„ìš”í•˜ì§€ ì•Šì€ íŒŒë¼ë¯¸í„°</h4>\n<p><code class=\"language-text\">createFestival</code> í•¸ë“¤ëŸ¬ ë©”ì„œë“œì—ì„œ <code class=\"language-text\">LoginMember</code> íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ì´ ì—†ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¸ì¦ì„ ìœ„í•´ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ì— LoginMember íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.</p>\n<h4>ì •ì  íŒŒì¼ì— ëŒ€í•œ ì¸ì¦</h4>\n<p>ì¸ì¦ ì‘ì—…ì„ <code class=\"language-text\">ArgumentResolver</code>ì—ì„œ ìˆ˜í–‰í•˜ë¯€ë¡œ, í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¡œ ì§€ì •ëœ ê²½ë¡œë§Œ ì¸ì¦ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ì •ì  íŒŒì¼ì— ëŒ€í•œ ì¸ì¦ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ê´€ë¦¬ì ì›¹ í˜ì´ì§€ì˜ JS íŒŒì¼ì´ ë…¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>ì–´ì°¨í”¼ JS íŒŒì¼ì„ ì—´ì–´ë³´ë”ë¼ë„ ì¸ì¦ì´ ë˜ì§€ ì•Šìœ¼ë©´ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ì—†ê¸´ í•˜ë‚˜, ê´€ë¦¬ìì˜ ì—”ë“œí¬ì¸íŠ¸ê°€ ë…¸ì¶œëœë‹¤ëŠ” ì ì´ ë³´ì•ˆ ì¸¡ë©´ì—ì„œ ì·¨ì•½í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<h3>ì–´ë–»ê²Œ í•´ê²°í•  ê²ƒì¸ê°€?</h3>\n<p>ì§€ê¸ˆê¹Œì§€ì˜ ìƒí™©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/0b265647b873388e8ef7e15f2a3b0896/ac7a9/20230822151035.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvklEQVR42p2R2Q6DIBBF/Xd/zlc+AOISFYlLohCsEfUWWtumldaep2GZe2cJVsuyLOsrTdOkaUopret6PSA4epBSdl0HCaWUL3kYBjh89PdzTSaEhGHoVJQFtvAsiiKO477vtdbuHgGOnHMhxC25bdsoihAYY3bVaZrwD5WP4+iKMpZ5nrXl0XNVVRgPfJIkYYzleY4Yo8LXy533pgKn6ipEmpPIsoxZuAXSZVk+1/Vl2r8ObF+1nxN7Puf8Bxv8SIH+gMWjswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230822151035' title='' src='/static/0b265647b873388e8ef7e15f2a3b0896/ca1dc/20230822151035.png' srcset='/static/0b265647b873388e8ef7e15f2a3b0896/e7570/20230822151035.png 170w,\n/static/0b265647b873388e8ef7e15f2a3b0896/f46e7/20230822151035.png 340w,\n/static/0b265647b873388e8ef7e15f2a3b0896/ca1dc/20230822151035.png 680w,\n/static/0b265647b873388e8ef7e15f2a3b0896/02d09/20230822151035.png 1020w,\n/static/0b265647b873388e8ef7e15f2a3b0896/9d567/20230822151035.png 1360w,\n/static/0b265647b873388e8ef7e15f2a3b0896/ac7a9/20230822151035.png 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/9abfa856a12fe1338a96666e271ca84b/ac7a9/20230822151040.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVR42qVQWwqCQBR1v7mbai2uwD4U8cMg+lIRfGITYvhoHp2ZCQlTSDoMF+dez+OOIYTg6nyCMRZFUZqmSZKEYcj5bP6GoSpmzxm5ruumaQghVVWtkm/kfjn78fUkNTgTW2BYlrUzzf3hyBiF1UOhbVs4IzbCo9l1ne7jA9c8z8uylGRsZdu27/s6rfKXIYdhIAp93+uRBqW0U5h2FhCLFaBVFAUqVkV/HEeooGrdhQeDWBAEnuc5joOKFK7rIjNsUbMsg5C2WnxtyZ9MkHPx11XyN/TmXGEz+S/nX/ACCzF9iC8fh5cAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230822151040' title='' src='/static/9abfa856a12fe1338a96666e271ca84b/ca1dc/20230822151040.png' srcset='/static/9abfa856a12fe1338a96666e271ca84b/e7570/20230822151040.png 170w,\n/static/9abfa856a12fe1338a96666e271ca84b/f46e7/20230822151040.png 340w,\n/static/9abfa856a12fe1338a96666e271ca84b/ca1dc/20230822151040.png 680w,\n/static/9abfa856a12fe1338a96666e271ca84b/02d09/20230822151040.png 1020w,\n/static/9abfa856a12fe1338a96666e271ca84b/9d567/20230822151040.png 1360w,\n/static/9abfa856a12fe1338a96666e271ca84b/ac7a9/20230822151040.png 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f7b8f51710fb3a4cd388ed910ed48ce2/ac7a9/20230822151045.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVR42p2SfW6CQBDFva+9jelZvAEkGkBJsSl+gaiJkQClBSwo2x87baOtf/WFTHZn5s3ue0tPKdXq7wdt2+73+91ut1qtttttFEXL5fJyuag/6Em/Us119lUjy7KiKJIkieOYiXfISZo9Pznhi8GmaeqzBq1N00CGKdvzN8i/a3Tk4XDY7z8MBo9kOe1NgwWnrdfr+XzOCFolz4JxaEFXR95EkWEYk8mETVVVHxqn0ylNU5qCIMjzvK7rSoMSQo7HI6O/NFNbLBYU5FZyPZKMKMtS8uoeOjI127YtyyI6juO67ng8loVpmp7nzWYzzOf+v2zrydugDTKc0WgkcTqdIofX4qk2G8RFYRgy4nA4IPvmZN/3bQ1XQy7C4TLC0mAo6vASLdfv3FlVaOAnEWNljVtiMhEL7v4k/8Qne+1o0bX1ykwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230822151045' title='' src='/static/f7b8f51710fb3a4cd388ed910ed48ce2/ca1dc/20230822151045.png' srcset='/static/f7b8f51710fb3a4cd388ed910ed48ce2/e7570/20230822151045.png 170w,\n/static/f7b8f51710fb3a4cd388ed910ed48ce2/f46e7/20230822151045.png 340w,\n/static/f7b8f51710fb3a4cd388ed910ed48ce2/ca1dc/20230822151045.png 680w,\n/static/f7b8f51710fb3a4cd388ed910ed48ce2/02d09/20230822151045.png 1020w,\n/static/f7b8f51710fb3a4cd388ed910ed48ce2/9d567/20230822151045.png 1360w,\n/static/f7b8f51710fb3a4cd388ed910ed48ce2/ac7a9/20230822151045.png 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>ë”°ë¼ì„œ ë¬¸ì œì ì„ í•´ê²°í•˜ë ¤ë©´, <code class=\"language-text\">ArgumentResolver</code>ë¡œ ì¸ì¦ì„ í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ <code class=\"language-text\">Interceptor</code>ë¡œ íŠ¹ì • ê²½ë¡œì— ëŒ€í•œ ì¸ì¦ì„ ìˆ˜í–‰í•˜ë©´ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>ì—¬ê¸°ì„œ <code class=\"language-text\">Interceptor</code>ëŠ”  <code class=\"language-text\">HandlerInterceptor</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë§í•©ë‹ˆë‹¤.</p>\n</blockquote>\n<p><code class=\"language-text\">Interceptor</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ìš”ì²­ê³¼ ì‘ë‹µì„ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë˜í•œ <code class=\"language-text\">HandlerInterceptor</code> ì¸í„°í˜ì´ìŠ¤ì—ëŠ” ì„¸ ê°œì˜ default ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">default</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">preHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> handler<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n   <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">postHandle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> handler<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token class-name\">ModelAndView</span> modelAndView<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span> \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterCompletion</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> handler<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ ì¤‘ì—ì„œ ì €í¬ê°€ ë´ì•¼í•  ë©”ì„œë“œëŠ” <code class=\"language-text\">preHandle()</code> ì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">preHandle()</code> ë©”ì„œë“œëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œë¡œ, í•´ë‹¹ ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ì—¬ ìš”ì²­ì´ í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¡œ ë„˜ì–´ê°€ê¸° ì „ì— ì¸ì¦ ê³¼ì •ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">HandlerInterceptor</code>ë¥¼ êµ¬í˜„í•œ InterceptorëŠ” ë‹¤ìŒê³¼ ê°™ì´ <code class=\"language-text\">WebMvcConfigurer</code>ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ì— <code class=\"language-text\">addInterceptors()</code> ë©”ì„œë“œë¥¼ ì¬ì •ì˜ í•œ ë’¤ <code class=\"language-text\">registry</code> íŒŒë¼ë¯¸í„°ì— ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WebConfig</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">WebMvcConfigurer</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addInterceptors</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterceptorRegistry</span> registry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        registry<span class=\"token punctuation\">.</span><span class=\"token function\">addInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token function\">adminAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">addPathPatterns</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/**\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/js/admin/**\"</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">excludePathPatterns</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        registry<span class=\"token punctuation\">.</span><span class=\"token function\">addInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token function\">memberAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">addPathPatterns</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/members/**\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">HandlerInterceptor</span> <span class=\"token function\">adminAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">,</span> authExtractor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>  \n      \n    <span class=\"token annotation punctuation\">@Bean</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">HandlerInterceptor</span> <span class=\"token function\">memberAuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">,</span> authExtractor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>Interceptor</h4>\n<p>ê¸°ì¡´ì˜ <code class=\"language-text\">ArgumentResolver</code>ì—ì„œëŠ” ìš”ì²­ì—ì„œ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒê³¼ í† í°ì„ <code class=\"language-text\">AuthExtractor</code>ì— ì „ë‹¬í•˜ì—¬ <code class=\"language-text\">LoginMember</code>ë¥¼ ë°˜í™˜í•˜ëŠ” ë‘ ê°€ì§€ì˜ ì±…ì„ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ìš”ì²­ì—ì„œ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ì±…ì„ì„ Interceptorë¡œ ìœ„ì„í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ°ë° ì‚¬ìš©ìì™€ ê´€ë¦¬ìëŠ” í† í°ì„ ë³´ë‚´ëŠ” ë°©ì‹ì´ ë‹¬ë¼ì„œ, ì—­í• ì— ë”°ë¼ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ë©”ì„œë“œë¥¼ ë¶„ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerInterceptor</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Role</span> role<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AuthExtractor</span> authExtractor<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">preHandle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> token<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>role <span class=\"token operator\">==</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            token <span class=\"token operator\">=</span> <span class=\"token function\">getHeaderToken</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>role <span class=\"token operator\">==</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            token <span class=\"token operator\">=</span> <span class=\"token function\">getCookieToken</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>token <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì´ ë°©ë²•ì€ ìƒˆë¡œìš´ ì—­í• ì´ ì¶”ê°€ëœë‹¤ë©´ ì¡°ê±´ë¬¸ì´ ì¶”ê°€ë¡œ ìƒê¸°ê²Œ ë  ê²ƒì´ê³  í•œëˆˆì— ë´ë„ ì´ ë°©ë²•ì€ ì© ìœ ì¾Œí•˜ì§€ ì•Šì•„ ë³´ì…ë‹ˆë‹¤.</p>\n<h4>ì„œë¡œ ë‹¤ë¥¸ ì¸ì¦ ë°©ì‹</h4>\n<p>ìœ„ì˜ êµ¬í˜„ì—ì„œëŠ” ìš”ì²­ì—ì„œ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ ì—­í• ì— ë”°ë¼ êµ¬ì²´ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì—­í• ì— ë”°ë¼ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì´ ë‹¤ë¥¸ ê²ƒì€ ë§ì§€ë§Œ, êµ³ì´ ì—­í• ì— ë”°ë¼ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ ë¶„ë¦¬í•  í•„ìš”ê°€ ìˆì„ê¹Œìš”?</p>\n<p>ì´ê²ƒì„ í•˜ë‚˜ì˜ ì±…ì„ìœ¼ë¡œ ë³¸ë‹¤ë©´ ë‹¤ë¥¸ ê°ì²´ê°€ ì´ê²ƒì„ ë‹´ë‹¹í•˜ê²Œ í•˜ëŠ” ê²ƒì„ ìƒê°í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TokenExtractor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë¦¬ê³  <code class=\"language-text\">TokenExtractor</code>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‘ ê°œì˜ êµ¬í˜„ì²´ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CookieTokenExtractor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">TokenExtractor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HeaderTokenExtractor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">TokenExtractor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì œ ìš”ì²­ì—ì„œ í† í°ì„ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì„ <code class=\"language-text\">TokenExtractor</code>ì— ìœ„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerInterceptor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">TokenExtractor</span> tokenExtractor<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">preHandle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> tokenExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getRole</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> role<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// boolean..?</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ëŸ°ë° <code class=\"language-text\">preHandle()</code> ë©”ì„œë“œì˜ ë°˜í™˜ íƒ€ì…ì€ booleanì¸ë°, ì–´ë–»ê²Œ AuthPayloadì— ìˆëŠ” ê°’ì„ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸¸ ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<h4>HandlerInterceptor -> ArgumentResolver</h4>\n<p><code class=\"language-text\">preHandle()</code> ë©”ì„œë“œë¡œ ë„˜ì–´ì˜¤ëŠ” <code class=\"language-text\">HttpServletRequest</code> ê°ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Object</span> <span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ë”°ë¼ì„œ Interceptorì—ì„œ ì¸ì¦ì´ ëë‚˜ê³  ë°˜í™˜ëœ <code class=\"language-text\">AuthPayload</code> ê°ì²´ë¥¼ <code class=\"language-text\">setAttribute()</code> ë©”ì„œë“œë¥¼ í†µí•´ <code class=\"language-text\">ArgumentResolver</code>ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthInterceptor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerInterceptor</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">preHandle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> tokenExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        request<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> authPayload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì œ <code class=\"language-text\">ArgumentResolver</code>ëŠ” WebRequest ê°ì²´ì˜  <code class=\"language-text\">getAttribute()</code> ë©”ì„œë“œë¥¼ í†µí•´ <code class=\"language-text\">AuthPayload</code>ë¥¼ êº¼ë‚¸ ë’¤, í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ íŒŒë¦¬ë¯¸í„°ì— ê°’ì„ ë§¤í•‘í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<blockquote>\n<p>Attributeì˜ keyê°€ ê²¹ì¹  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, <code class=\"language-text\">AuthPayload.class.getName()</code>ê³¼ ê°™ì´ í•´ë‹¹ í´ë˜ìŠ¤ì˜ ê³ ìœ í•œ íŒ¨í‚¤ì§€ ëª…ê³¼ í´ë˜ìŠ¤ ëª…ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthArgumentResolver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">HandlerMethodArgumentResolver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LogimMember</span> <span class=\"token function\">resolveArgument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> <span class=\"token function\">getAuthPayload</span><span class=\"token punctuation\">(</span>webRequest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginMember</span><span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">AuthPayload</span> <span class=\"token function\">getAuthPayload</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">NativeWebRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">)</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">RequestAttributes</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SCOPE_REQUEST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>authPayload <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ANONYMOUS</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// new AuthPayload(null, Role.ANONYMOUS); </span>\n        <span class=\"token punctuation\">}</span>  \n        <span class=\"token keyword\">return</span> authPayload<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë”°ë¼ì„œ ì´ì œë¶€í„° ì‚¬ìš©ìê°€ ì ‘ì†í•˜ëŠ” ê²½ë¡œì— ë”°ë¼ ì¸ì¦ê³¼ ì¸ê°€ ê¸°ëŠ¥ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/ccc57d736671895370bf241baf93d197/ac7a9/20230822170744.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVR42pWRSwuEMAyE/f9n/WUePPhGUEFFD+paH9v9aBTElX3MoU1KZiZJLa3100AfGIbBdd0wDIMgSJLE87wsy8Zx1G+w5DqTiSl9GBCgpZTatu2eHEWRbdsE8zwvy0IpBGjbAVS6ruv7fjHoDXZyHMeO4xDwJFa+7/OIiqRN0xRFUdc1KpKitZPXdRUlAf7SM4H+iOvMODCFKLKwtm0vGzkv2LqI5XlelqVUVFVFk9+dBbgpA9ntNE23S74hMyF/izN/m6YpKSe7+YlMn3jCkRNPnPmYX9v+Fy9h34FlH9VDTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230822170744' title='' src='/static/ccc57d736671895370bf241baf93d197/ca1dc/20230822170744.png' srcset='/static/ccc57d736671895370bf241baf93d197/e7570/20230822170744.png 170w,\n/static/ccc57d736671895370bf241baf93d197/f46e7/20230822170744.png 340w,\n/static/ccc57d736671895370bf241baf93d197/ca1dc/20230822170744.png 680w,\n/static/ccc57d736671895370bf241baf93d197/02d09/20230822170744.png 1020w,\n/static/ccc57d736671895370bf241baf93d197/9d567/20230822170744.png 1360w,\n/static/ccc57d736671895370bf241baf93d197/ac7a9/20230822170744.png 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h3>ì¸ì¦ ì¸ê°€ í…ŒìŠ¤íŠ¸</h3>\n<p>ê·¸ë ‡ë‹¤ë©´ ì´ì œ ëª¨ë“  ê¸°ëŠ¥ì„ ì œì‘í–ˆìœ¼ë‹ˆ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ê² ì£ ?</p>\n<p>ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ì ‘ì†í•  ë•Œ, ê´€ë¦¬ì ê¶Œí•œì´ ì•„ë‹Œ ì‚¬ìš©ìë©´ 401 ìƒíƒœì½”ë“œê°€ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@WebMvcTest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AdminController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AdminControllerTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> í† í°ì˜_Roleì´_ì–´ë“œë¯¼ì´_ì•„ë‹ˆë©´<span class=\"token function\">_401</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token comment\">// when &amp; then  </span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isUnauthorized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•´ë‹¹ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ë‹¹ì—°í•˜ê²Œ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>\n<p>ì™œëƒí•˜ë©´ <code class=\"language-text\">Interceptor</code> í•„ë“œì˜ <code class=\"language-text\">AuthExtractor</code>ê°€ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p>ë˜í•œ <code class=\"language-text\">AuthExtractor</code>ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ê³ , í•´ë‹¹ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” JWT í† í°ìœ¼ë¡œ ì¸ì¦ì„ í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ Mockitoì˜ <code class=\"language-text\">@MockBean</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ê±°ë‚˜, í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì—ì„œ <code class=\"language-text\">@Import</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ <code class=\"language-text\">AuthExtractor</code>ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Import</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FakeAuthExtractor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// Fake</span>\n<span class=\"token annotation punctuation\">@WebMvcTest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AdminController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AdminControllerTest</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@MockBean</span>\n    <span class=\"token class-name\">AuthExtractor</span> authExtractor<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Mock</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ëŸ°ë° ì´ë ‡ê²Œ Fake ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, Mock ê°ì²´ë¥¼ ì‚¬ìš©í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<h4>Fake ì‚¬ìš©ì˜ ë¬¸ì œ</h4>\n<p><code class=\"language-text\">FakeAuthExtractor</code> í´ë˜ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FakeAuthExtractor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AuthExtractor</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthPayload</span> <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">,</span> <span class=\"token string\">\"member\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">,</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ANONYMOUS</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JWT í† í°ì„ ì§ì ‘ íŒŒì‹±í•˜ì—¬, AuthPayload ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ í•„ìš”ëŠ” ì—†ìœ¼ë‹ˆ ë‹¨ìˆœíˆ í•˜ë“œì½”ë”©ëœ ê°’ìœ¼ë¡œ AuthPayload ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ í•´ë‹¹ Fake ê°ì²´ì˜ ë¬¸ì œì ì€ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ <code class=\"language-text\">FakeAuthExtractor</code>ì˜ êµ¬í˜„ ì‚¬í•­ì— ì˜ì¡´ì ìœ¼ë¡œ ë³€í•˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ìƒˆë¡œìš´ ì—­í• ì´ ìƒê¸°ë©´ FakeAuthExtractorë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤!</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isUnauthorized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<h4>Mock ì‚¬ìš©ì˜ ë¬¸ì œ</h4>\n<p>Mockitoë¥¼ ì‚¬ìš©í•˜ë©´ Stub ê°ì²´ë¥¼ ë§¤ìš° ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ Stubì´ í•„ìš”í•œ ë©”ì„œë“œë§ˆë‹¤  <code class=\"language-text\">given()</code>ê³¼ ê°™ì´ ëª¨ì˜ ë™ì‘ì„ ì •ì˜í•´ ì¤˜ì•¼ í•˜ëŠ” ì¤‘ë³µ ì½”ë“œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">test1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// given</span>\n    <span class=\"token function\">given</span><span class=\"token punctuation\">(</span>authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token function\">anyString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    \n        <span class=\"token punctuation\">.</span><span class=\"token function\">willReturn</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">test2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// given</span>\n    <span class=\"token function\">given</span><span class=\"token punctuation\">(</span>authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token function\">anyString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    \n        <span class=\"token punctuation\">.</span><span class=\"token function\">willReturn</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span><span class=\"token number\">1L</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>ê³µí†µì ì¸ ë¬¸ì œì </h4>\n<p>ê²°êµ­ Fake ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë˜, Mock ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë“  ê°„ì— í…ŒìŠ¤íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë ¤ë©´ <code class=\"language-text\">AuthExtrator</code> ë¹ˆì´ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë§ˆë‹¤ í•´ë‹¹ ê°ì²´ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ì½”ë“œë¥¼ ë§¤ë²ˆ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Import</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FakeAuthExtractor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\">// ë˜ëŠ”</span>\n\n<span class=\"token annotation punctuation\">@MockBean</span>\n<span class=\"token class-name\">AuthExtractor</span> authExtractor<span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì´ëŸ¬í•œ ë¬¸ì œì ì€  <code class=\"language-text\">@WebMvcTest</code> í…ŒìŠ¤íŠ¸ì—ì„œ, MVC ê´€ë ¨ ë¹ˆë“¤ë§Œ ë¶ˆëŸ¬ì˜¤ê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@TypeExcludeFilters</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebMvcTypeExcludeFilter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">--</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">public</span> <span class=\"token annotation punctuation\">@interface</span> <span class=\"token class-name\">WebMvcTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">WebMvcTypeExcludeFilter</code> í´ë˜ìŠ¤ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ íŠ¹ì • ë¹ˆë“¤ë§Œ ë“±ë¡í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WebMvcTypeExcludeFilter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">StandardAnnotationCustomizableTypeExcludeFilter</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WebMvcTest</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">static</span> <span class=\"token punctuation\">{</span>  \n       <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Class</span><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> includes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedHashSet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ControllerAdvice</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonComponent</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebMvcConfigurer</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WebMvcRegistrations</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token namespace\">jakarta<span class=\"token punctuation\">.</span>servlet<span class=\"token punctuation\">.</span></span>Filter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FilterRegistrationBean</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DelegatingFilterProxyRegistrationBean</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HandlerMethodArgumentResolver</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpMessageConverter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorAttributes</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Converter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GenericConverter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n       includes<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HandlerInterceptor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë ‡ë‹¤ë©´ í•´ê²°ë²•ì€ ìƒê°ë³´ë‹¤ ë‹¨ìˆœí•©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">@WebMvcTest</code> ì–´ë…¸í…Œì´ì…˜ì„ í™•ì¥í•œ ì»¤ìŠ¤í…€ <code class=\"language-text\">@WebMvcTest</code> ì–´ë…¸í…Œì´ì…˜ì„ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@WebMvcTest</span>  \n<span class=\"token annotation punctuation\">@Import</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestAuthConfig</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  \n<span class=\"token annotation punctuation\">@Retention</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RetentionPolicy</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RUNTIME</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">public</span> <span class=\"token annotation punctuation\">@interface</span> <span class=\"token class-name\">CustomWebMvcTest</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token annotation punctuation\">@AliasFor</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controllers\"</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">value</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token annotation punctuation\">@AliasFor</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span>  \n    <span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">controllers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">@WebMvcTest</code>ì—ëŠ” ì†ì„±ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ì»¨íŠ¸ë¡¤ëŸ¬ì˜ í´ë˜ìŠ¤ë¥¼ ì ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ë§Œì•½ ì ì–´ì£¼ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë¹ˆìœ¼ë¡œ ì£¼ì…í•˜ë‹ˆ, <code class=\"language-text\">NoSuchBeanDefinitionException</code> ì˜ˆì™¸ê°€ ë°œìƒí•˜ë¯€ë¡œ íŠ¹ì • ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ì ì–´ì£¼ê¸° ìœ„í•´ ê¸°ì¡´ <code class=\"language-text\">@WebMvcTest</code> ì–´ë…¸í…Œì´ì…˜ì— ìˆë˜ íŒŒë¼ë¯¸í„°ë“¤ì„ ì ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ë¦¬ê³  <code class=\"language-text\">@Import</code> ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ <code class=\"language-text\">TestAuthConfig</code> í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ì£¼ì…í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">TestAuthConfig</code> í´ë˜ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@TestConfiguration</span>  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAuthConfig</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthExtractor</span> <span class=\"token function\">authExtractor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// return Mockito.mock(AuthExtractor.class);</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FakeAuthExtractor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì œ <code class=\"language-text\">@CustomWebMvcTest</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤!</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@CustomWebMvcTest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AdminController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AdminControllerTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token keyword\">void</span> í† í°ì˜_Roleì´_ì–´ë“œë¯¼ì´_ì•„ë‹ˆë©´<span class=\"token function\">_401</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token comment\">// when &amp; then  </span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isUnauthorized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>ì—¬ì „í•œ ë¬¸ì œì </h3>\n<p>í•˜ì§€ë§Œ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì§€ìš°ê¸´ í–ˆì–´ë„ ì—¬ì „íˆ ê·¼ë³¸ì ì¸ ë¬¸ì œëŠ” ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.</p>\n<p>Fakeë¥¼ ì‚¬ìš©í•  ê²ƒì´ëƒ, Mockì„ ì‚¬ìš©í•  ê²ƒì´ëƒì…ë‹ˆë‹¤.</p>\n<p>Fakeë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ Fakeì˜ ë™ì‘ì— ì¢…ì†ì ìœ¼ë¡œ ë˜ê³ , Mockì„ ì‚¬ìš©í•œë‹¤ë©´ ë§¤ë²ˆ ëª¨ì˜ ë™ì‘ì„ ì •ì˜í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p>í•´ë‹¹ í…ŒìŠ¤íŠ¸ì˜ í•µì‹¬ì€ ì¸ì¦ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì¸ì¦ì´ ëœ ì‚¬ìš©ìë§Œ ìš”ì²­ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ì¸ì¦ì˜ êµ¬ì²´ì ì¸ ë°©ë²•ì€ ì¤‘ìš”í•˜ì§€ ì•Šê³ , ê²½ë¡œì— ë”°ë¼ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€, í—¤ë”ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ì™€ ì¸ê°€ëœ ì‚¬ìš©ìë¥¼ êµ¬ë¶„ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<p>ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ì´ëŸ° ì‘ì—…ì„ ì¤‘ë³µëœ ì½”ë“œ ì—†ì´ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<h4>TestExecutionListener</h4>\n<p>ìŠ¤í”„ë§ì€ ë‹¤ìŒê³¼ ê°™ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TestExecutionListener</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeTestClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">prepareTestInstance</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterTestClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ, ì „ì²˜ë¦¬ ê³¼ì •ì„ ìˆ˜í–‰í•  ë©”ì„œë“œë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— ë“±ë¡ì‹œí‚¤ë©´ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì—†ì•¨ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë‹¤ìŒê³¼ ê°™ì´ ì»¤ìŠ¤í…€ ì–´ë…¸í…Œì´ì…˜ì„ ë§Œë“¤ì–´, ì¸ì¦ì´ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë§ˆë‹¤ ì ìš©ì„ í•œë‹¤ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Retention</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RetentionPolicy</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RUNTIME</span><span class=\"token punctuation\">)</span>  \n<span class=\"token annotation punctuation\">@Target</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ElementType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">METHOD</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">public</span> <span class=\"token annotation punctuation\">@interface</span> <span class=\"token class-name\">WithMockAuth</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">long</span> <span class=\"token function\">id</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token class-name\">Role</span> <span class=\"token function\">role</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> ì‚¬ìš©ìê°€_ë¡œê·¸ì¸ì„_í•˜ì§€_ì•Šìœ¼ë©´_ì•„ë‹ˆë©´<span class=\"token function\">_401</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// when &amp; then  </span>\n    mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isUnauthorized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token annotation punctuation\">@WithMockAuth</span><span class=\"token punctuation\">(</span>role <span class=\"token operator\">=</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MEMBER</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">void</span> ì‚¬ìš©ìê°€_ì–´ë“œë¯¼ì´_ì•„ë‹ˆë©´<span class=\"token function\">_401</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// when &amp; then  </span>\n    mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isUnauthorized</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token annotation punctuation\">@WithMockAuth</span><span class=\"token punctuation\">(</span>role <span class=\"token operator\">=</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">void</span> ì‚¬ìš©ìê°€_ì–´ë“œë¯¼_ì´ë©´<span class=\"token function\">_200</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\">// when &amp; then  </span>\n    mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin\"</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">cookie</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ikOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì–´ë–»ê²Œ êµ¬í˜„ì„ í•´ì•¼í• ê¹Œìš”?</p>\n<h4>TestExecutionListener êµ¬í˜„</h4>\n<p>ì ê¹ <code class=\"language-text\">AuthInterceptor</code>ì˜ <code class=\"language-text\">preHandle()</code> ë©”ì„œë“œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">preHandle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> token <span class=\"token operator\">=</span> tokenExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">AuthPayload</span> authPayload <span class=\"token operator\">=</span> authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getRole</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> role<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ForbiddenException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> authPayload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì¸ì¦, ì¸ê°€ì— ëŒ€í•œ ê°€ì¥ í° í•µì‹¬ì ì¸ ë¶€ë¶„ì€ <code class=\"language-text\">AuthExtractor</code> í´ë˜ìŠ¤ì˜ <code class=\"language-text\">extract()</code> ë©”ì„œë“œ ì…ë‹ˆë‹¤.</p>\n<p>ê·¸ë ‡ë‹¤ë©´ <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ê°€ ìˆ˜í–‰ë˜ê¸° ì „ ì „ì²˜ë¦¬ ì‘ì—…ì„ í†µí•´ì„œ <code class=\"language-text\">extract()</code> ë©”ì„œë“œì˜ ë°˜í™˜ ê°’ì„ ì¡°ì‘í•˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">TestExecutionListener</code>ì˜ ì¶”ìƒ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ì—ëŠ” ê³µí†µìœ¼ë¡œ <code class=\"language-text\">TestContext</code> ê°ì²´ê°€ ì œê³µë©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">TestContext</code> ê°ì²´ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TestContext</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AttributeAccessor</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serializable</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token class-name\">Method</span> <span class=\"token function\">getTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token class-name\">ApplicationContext</span> <span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">getTestMethod()</code> ë©”ì„œë“œë¡œ ì œê³µë˜ëŠ” <code class=\"language-text\">Method</code> ê°ì²´ì—ëŠ” ë©”ì†Œë“œì— íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ê°€ì ¸ì˜¤ëŠ” ë©”ì„œë“œê°€ ì œê³µë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isAnnotationPresent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Annotation</span><span class=\"token punctuation\">></span></span> annotationClass<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">isAnnotationPresent</span><span class=\"token punctuation\">(</span>annotationClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Annotation</span><span class=\"token punctuation\">></span></span> <span class=\"token class-name\">T</span> <span class=\"token function\">getDeclaredAnnotation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">></span></span> annotationClass<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAnnotation</span><span class=\"token punctuation\">(</span>annotationClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì— íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì–´ìˆìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<ol>\n<li>í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì— íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì–´ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</li>\n<li>íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì„ ê°€ì ¸ì˜¨ë‹¤.</li>\n<li>ApplicationContext ê°ì²´ë¥¼ ê°€ì ¸ì˜¨ ë’¤, AuthExtractor ë¹ˆì„ êº¼ë‚¸ë‹¤.</li>\n<li>AuthExtractorê°€ íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì˜ ì†ì„±ìœ¼ë¡œ ì •ì˜ëœ í•„ë“œë¥¼ ë°˜í™˜í•˜ë„ë¡ í•œë‹¤.</li>\n</ol>\n<p>í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  <code class=\"language-text\">AuthExtractor</code> ê°ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í•˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MockAuthExtractor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AuthExtractor</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> memberId <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Role</span> role <span class=\"token operator\">=</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ANONYMOUS</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setMemberId</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> memberId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberId <span class=\"token operator\">=</span> memberId<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setRole</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Role</span> role<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>role <span class=\"token operator\">=</span> role<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthPayload</span> <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span>memberId<span class=\"token punctuation\">,</span> role<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë¦¬ê³  <code class=\"language-text\">TestExecutionListener</code>ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ì—ì„œ <code class=\"language-text\">beforeTestMethod()</code> ë©”ì„œë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>\n<p>ë˜í•œ í…ŒìŠ¤íŠ¸ê°€ ëë‚˜ë©´ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ê°€ ì˜í–¥ì„ ë°›ì§€ ì•Šì•„ì•¼ í•˜ë¯€ë¡œ, <code class=\"language-text\">afterTestMethod()</code> ë©”ì„œë“œë„ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MockAuthTestExecutionListener</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">TestExecutionListener</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">beforeTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">Method</span> testMethod <span class=\"token operator\">=</span> testContext<span class=\"token punctuation\">.</span><span class=\"token function\">getTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>testMethod<span class=\"token punctuation\">.</span><span class=\"token function\">isAnnotationPresent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WithMockAuth</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">WithMockAuth</span> withMockAuth <span class=\"token operator\">=</span> testMethod<span class=\"token punctuation\">.</span><span class=\"token function\">getDeclaredAnnotation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WithMockAuth</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token class-name\">ApplicationContext</span> applicationContext <span class=\"token operator\">=</span> testContext<span class=\"token punctuation\">.</span><span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token class-name\">MockAuthExtractor</span> authExtractor <span class=\"token operator\">=</span> applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MockAuthExtractor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setMemberId</span><span class=\"token punctuation\">(</span>withMockAuth<span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setRole</span><span class=\"token punctuation\">(</span>withMockAuth<span class=\"token punctuation\">.</span><span class=\"token function\">role</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">afterTestMethod</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestContext</span> testContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span> \n        <span class=\"token class-name\">ApplicationContext</span> applicationContext <span class=\"token operator\">=</span> testContext<span class=\"token punctuation\">.</span><span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">MockAuthExtractor</span> authExtractor <span class=\"token operator\">=</span> applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MockAuthExtractor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setMemberId</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        authExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">setRole</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ANONYMOUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë¦¬ê³  ì´ì „ì— ë§Œë“¤ì—ˆë˜ <code class=\"language-text\">@CustomWebMvcTest</code>ì— <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ë©´ ëª¨ë“  ì‘ì—…ì´ ëë‚©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@WebMvcTest</span>  \n<span class=\"token annotation punctuation\">@Import</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TestAuthConfig</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  \n<span class=\"token annotation punctuation\">@Retention</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RetentionPolicy</span><span class=\"token punctuation\">.</span><span class=\"token constant\">RUNTIME</span><span class=\"token punctuation\">)</span>  \n<span class=\"token annotation punctuation\">@TestExecutionListeners</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MockAuthTestExecutionListener</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">--</span>\n<span class=\"token keyword\">public</span> <span class=\"token annotation punctuation\">@interface</span> <span class=\"token class-name\">CustomWebMvcTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´, ë‹¤ìŒê³¼ ê°™ì€ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©° í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>NullPointerException</span><span class=\"token operator\">:</span> <span class=\"token class-name\">Cannot</span> invoke <span class=\"token string\">\"com.festago.application.StageService.create(com.festago.dto.StageCreateRequest)\"</span> because <span class=\"token string\">\"this.stageService\"</span> is <span class=\"token keyword\">null</span></code></pre></div>\n<p>ì™œëƒí•˜ë©´ <code class=\"language-text\">@WebMvcTest</code>ë¥¼ ìˆ˜í–‰í•  ë•Œ, ê¸°ë³¸ì ìœ¼ë¡œ ë“±ë¡ëœ <code class=\"language-text\">TestExecutionListener</code>ê°€ ìˆëŠ”ë° <code class=\"language-text\">@TestExecutionListeners</code>ë¥¼ ìƒˆë¡­ê²Œ ì‚¬ìš©í•˜ë©´ì„œ ê¸°ì¡´ì˜ <code class=\"language-text\">TestExecutionListener</code>ê°€ ëŒ€ì²´ë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ìƒˆë¡œìš´ <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ë“±ë¡í•˜ë©´ì„œ ê¸°ì¡´ì˜ <code class=\"language-text\">TestExecutionListener</code>ëŠ” ìœ ì§€ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ì´ê²ƒì€ <code class=\"language-text\">@TestExecutionListeners</code>ì˜ <code class=\"language-text\">mergeMode</code> ì†ì„±ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@TestExecutionListeners</span><span class=\"token punctuation\">(</span>listeners <span class=\"token operator\">=</span> <span class=\"token class-name\">MockAuthTestExecutionListener</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> mergeMode <span class=\"token operator\">=</span> <span class=\"token class-name\">MergeMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">MERGE_WITH_DEFAULTS</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">@TestExecutionListeners</code>ì˜ <code class=\"language-text\">mergeMode</code> ì†ì„±ì˜ ê¸°ë³¸ê°’ì€ <code class=\"language-text\">REPLACE_DEFAULTS</code> ì…ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ <code class=\"language-text\">MERGE_WITH_DEFAULTS</code> ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ì˜ <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ëŒ€ì²´í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì´ì œ ì¸ì¦, ì¸ê°€ê°€ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ì— ë‹¤ìŒê³¼ ê°™ì€ ì–´ë…¸í…Œì´ì…˜ë§Œ ì¶”ê°€ì‹œí‚¤ë©´ ê°„í¸í•˜ê²Œ ì¸ì¦, ì¸ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@CustomWebMvcTest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthController</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthControllerTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token annotation punctuation\">@WithMockAuth</span><span class=\"token punctuation\">(</span>role <span class=\"token operator\">=</span> <span class=\"token class-name\">Role</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">void</span> ë©¤ë²„_ê¶Œí•œì´_ì•„ë‹Œë°_íƒˆí‡´í•˜ë©´_ì˜ˆì™¸<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/auth\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bearer token\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNotFound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Test</span>\n    <span class=\"token annotation punctuation\">@WithMockAuth</span>\n    <span class=\"token keyword\">void</span> íšŒì›_íƒˆí‡´ë¥¼_í•œë‹¤<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        mockMvc<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/auth\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bearer token\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">contentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">andExpect</span><span class=\"token punctuation\">(</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isOk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>ê²°ë¡ </h2>\n<p>ê¸°ì¡´ì˜ ì¸ì¦ ë°©ì‹ì—ëŠ” í•˜ë‚˜ì˜ ì—­í• ë§Œ ì¡´ì¬í•˜ì—¬, í•˜ë‚˜ì˜ ì¸ì¦ ë°©ì‹ë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ ë‹¨ìˆœí•œ ë°©ì‹ì˜ ì¸ì¦ ê¸°ëŠ¥ë§Œ ìˆ˜í–‰í•˜ë©´ ëìŠµë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ê´€ë¦¬ì ë˜ëŠ” ìŠ¤íƒœí”„ê°™ì´ ë‹¤ì–‘í•œ ì—­í• ì˜ ì‚¬ìš©ìê°€ ì¶”ê°€ë˜ì–´ ì¶”ê°€ì ì¸ ì¸ì¦ ë°©ì‹ì´ í•„ìš”í•˜ê²Œ ëìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ìƒˆë¡œìš´ ì¸ì¦ ë°©ì‹ì´ ì¶”ê°€ ë˜ë”ë¼ë„ í° ë³€ê²½ ì—†ì´ ì¸ì¦ ë° ì¸ê°€ ì‘ì—…ì´ í•„ìš”í•˜ì˜€ê³ , ì¸ì¦, ì¸ê°€ë¥¼ <code class=\"language-text\">Interceptor</code>ì—ì„œ ìˆ˜í–‰í•˜ë„ë¡ í•œ ë’¤, í† í°ì„ ì¶”ì¶œí•˜ê³  í† í°ì—ì„œ ì¸ì¦ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ì±…ì„ì„ ê°€ì§„ ê°ì²´ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì¬ì‚¬ìš©ì„±ì´ ë†’ì€ ì½”ë“œë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p>\n<p>ë˜í•œ <code class=\"language-text\">@WebMvcTest</code> í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ ì¸ì¦, ì¸ê°€ ì‘ì—…ìœ¼ë¡œ ì¤‘ë³µì ìœ¼ë¡œ ë°œìƒí•˜ê²Œ ë˜ëŠ” ì½”ë“œ ë˜í•œ ì»¤ìŠ¤í…€ ì–´ë…¸í…Œì´ì…˜ê³¼ <code class=\"language-text\">TestExecutionListener</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¤‘ë³µëœ ì½”ë“œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë§Œì•½ <code class=\"language-text\">Request</code> ê°ì²´ì˜ <code class=\"language-text\">Attribute</code>ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´, <code class=\"language-text\">RequestScope</code> ë²”ìœ„ë¥¼ ê°€ì§„ ë¹ˆì„ ì£¼ì…í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p><code class=\"language-text\">Attribute</code>ì—ì„œ ê°’ì„ êº¼ë‚¼ ë•Œ Object íƒ€ì…ìœ¼ë¡œ ì¶”ì¶œì´ ë˜ë¯€ë¡œ, í˜•ë³€í™˜ ê³¼ì •ì´ í•„ìš”í•˜ê³ , êº¼ë‚¸ ê°ì²´ê°€ nullable í•˜ë¯€ë¡œ í˜ìŠ¤íƒ€ê³ ì˜ ì‹¤ì œ ì½”ë“œì—ì„œëŠ” <code class=\"language-text\">RequestScope</code> ë²”ìœ„ì˜ ë¹ˆì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n</blockquote>","frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ì¸ì¦ê³¼ ì¸ê°€","date":"August 24, 2023","update":"August 24, 2023","tags":["OAuth2"],"series":null},"fields":{"slug":"/oauth2-multiple-user-auth/","readingTime":{"minutes":31.84}}},"seriesList":{"edges":[{"node":{"id":"9ecb7f42-84ec-536a-9bfc-a3affcb87512","fields":{"slug":"/oauth2-select-and-apply/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - OAuth2ë¥¼ ì„ íƒí•˜ê³  ì ìš©í•œ ë°©ë²•"}}},{"node":{"id":"1c28c731-cebd-5aab-b9bd-a5c397bf9c7a","fields":{"slug":"/oauth2-multiple-user-auth/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ì¸ì¦ê³¼ ì¸ê°€"}}}]},"previous":{"fields":{"slug":"/oauth2-select-and-apply/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - OAuth2ë¥¼ ì„ íƒí•˜ê³  ì ìš©í•œ ë°©ë²•"}},"next":null},"pageContext":{"id":"1c28c731-cebd-5aab-b9bd-a5c397bf9c7a","series":null,"previousPostId":"9ecb7f42-84ec-536a-9bfc-a3affcb87512","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}