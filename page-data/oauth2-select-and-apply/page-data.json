{"componentChunkName":"component---src-templates-post-jsx","path":"/oauth2-select-and-apply/","result":{"data":{"site":{"siteMetadata":{"title":"Festago"}},"markdownRemark":{"id":"9ecb7f42-84ec-536a-9bfc-a3affcb87512","excerpt":"ì„œë¡  ì•ˆë…•í•˜ì„¸ìš”. í˜ìŠ¤íƒ€ê³ ì˜ ê¸€ë Œì…ë‹ˆë‹¤. ğŸ¥ƒ í˜ìŠ¤íƒ€ê³ ëŠ” ì¸ì¦ì„ êµ¬í˜„í•  ë•Œ, ìµœì†Œí•œì˜ ì •ë³´ë¡œ ì•ˆì „í•˜ê²Œ ì¸ì¦ì„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” OAuth2ë¥¼ ì±„íƒí•˜ì˜€ìŠµë‹ˆë‹¤. OAuth2ë¥¼ êµ¬í˜„í•  ë•Œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” íšŒì‚¬ë“¤ì€ ë§¤ìš° ë§ìŠµë‹ˆë‹¤. ê·¸ì¤‘ì—ì„œ ì €í¬ê°€ ì„ íƒí•œ OAuth2 ì œê³µìëŠ”  ì…ë‹ˆë‹¤. ì¹´ì¹´ì˜¤í†¡ì„ ì„ íƒí•œ ì´ìœ ëŠ” ì €í¬ ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±ìƒ ì‚¬ìš©ì ê°„ì˜ í‹°ì¼“ ê±°ë˜ë¥¼ ë§‰ê¸° ìœ„â€¦","html":"<h2>ì„œë¡ </h2>\n<p>ì•ˆë…•í•˜ì„¸ìš”.</p>\n<p>í˜ìŠ¤íƒ€ê³ ì˜ ê¸€ë Œì…ë‹ˆë‹¤. ğŸ¥ƒ</p>\n<p>í˜ìŠ¤íƒ€ê³ ëŠ” ì¸ì¦ì„ êµ¬í˜„í•  ë•Œ, ìµœì†Œí•œì˜ ì •ë³´ë¡œ ì•ˆì „í•˜ê²Œ ì¸ì¦ì„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” OAuth2ë¥¼ ì±„íƒí•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<p>OAuth2ë¥¼ êµ¬í˜„í•  ë•Œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” íšŒì‚¬ë“¤ì€ ë§¤ìš° ë§ìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ì¤‘ì—ì„œ ì €í¬ê°€ ì„ íƒí•œ OAuth2 ì œê³µìëŠ” <code class=\"language-text\">ì¹´ì¹´ì˜¤í†¡</code> ì…ë‹ˆë‹¤.</p>\n<p>ì¹´ì¹´ì˜¤í†¡ì„ ì„ íƒí•œ ì´ìœ ëŠ” ì €í¬ ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±ìƒ ì‚¬ìš©ì ê°„ì˜ í‹°ì¼“ ê±°ë˜ë¥¼ ë§‰ê¸° ìœ„í•¨ì¸ë°ìš”.</p>\n<p>êµ¬ê¸€ì´ë‚˜ í˜ì´ìŠ¤ë¶ ë“± ì‰½ê²Œ ê³„ì •ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ëŠ” í•œ ëª…ì˜ ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ê³„ì •ì„ í†µí•´ í‹°ì¼“ì„ ì˜ˆë§¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, êµ­ë‚´ì—ì„œ ìœ ì¼í•œ ì „í™”ë²ˆí˜¸ë¡œ ê³„ì •ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ ì œê³µìì¸ ì¹´ì¹´ì˜¤í†¡ì„ ì„ íƒí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n<p>í˜ìŠ¤íƒ€ê³ ì—ì„œ êµ¬í˜„í•œ OAuth2ì˜ ì¸ì¦ í”Œë¡œìš°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/83a6a914cae127d31cb921cf481a572a/ac7a9/20230819155223.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVR42l1SW3KjMBD0/U+QS+whkp+tWr+JSQwSoAiQBbgc4bWJ0IvVY2O7Mh9iRnSrumdmNvkQUhpjpv9hRv1lz1BoLSQ/Tw8xjFJ78ExrbT/PL89d14V/F37+lTwN4yWU7FSTYu6e9AQh5O8IDl/ckQMiy3PW9zbhnCNU7NOYUiqEMEYnSbJYrq/Xa0AeCFksl3meO3IQdxoUO1+Oxw4AgD7wW5pDAOI4bijFNaHMqbjZYFxzoe5kxg2XumloXVVVTaI9hBBAd4AUQICqA6lxWTZt68DjJJzXb9m2lnrSSkkpD7R53YMsy4qiQAglKYzeQds00scNfCf337VVp8yUk+MHKsqyJKROs9zKNlpJpexQlBT9DzJ7IFsjBT1F2+1ms4l3u2gXr3fvr9F2tVr/mc9XizmoWm/W3Mm2B1a11W2TAxt69mmVY4wRLiGubS+sBWvkzD7bv6P07FmYXtn1UfyW+RbZBB9731c/WO2eDt0O4J8N40K6JdMulNZS37bNcZR5XDBXhot/telv4az6RtoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230819155223' title='' src='/static/83a6a914cae127d31cb921cf481a572a/ca1dc/20230819155223.png' srcset='/static/83a6a914cae127d31cb921cf481a572a/e7570/20230819155223.png 170w,\n/static/83a6a914cae127d31cb921cf481a572a/f46e7/20230819155223.png 340w,\n/static/83a6a914cae127d31cb921cf481a572a/ca1dc/20230819155223.png 680w,\n/static/83a6a914cae127d31cb921cf481a572a/02d09/20230819155223.png 1020w,\n/static/83a6a914cae127d31cb921cf481a572a/9d567/20230819155223.png 1360w,\n/static/83a6a914cae127d31cb921cf481a572a/ac7a9/20230819155223.png 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>ì´ ë°©ì‹ì€ <code class=\"language-text\">Authorization Code Grant Type</code>ë¼ê³  ë¶ˆë¦¬ëŠ” OAuth2 ì¸ì¦ ë°©ì‹ì˜ ì¢…ë¥˜ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.</p>\n<p>í•´ë‹¹ ì¸ì¦ ë°©ì‹ì€ ì‚¬ìš©ìëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” OAuth2 ì¸ì¦ ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³ , ì¸ì¦ ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸(ë°±ì—”ë“œ ìŠ¤í”„ë§ ì„œë²„)ì— ì—‘ì„¸ìŠ¤ í† í°ê³¼ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p>\n<p>ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ìì˜ ì—‘ì„¸ìŠ¤ í† í°ê³¼ ì‚¬ìš©ì ì •ë³´ì˜ ë…¸ì¶œì„ ìµœì†Œí™”í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë³´ì•ˆì˜ ì‹ ë¢°ì„±ì´ ë†’ìŠµë‹ˆë‹¤.</p>\n<p>ì´ëŸ¬í•œ ë°©ì‹ì„ ì–´ë–»ê²Œ ì½”ë“œë¡œ êµ¬í˜„í•˜ì˜€ëŠ”ì§€ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<p>ì½”ë“œë¡œ êµ¬í˜„í•  í´ë˜ìŠ¤ë¥¼ ê°„ëµíˆ ë‚˜íƒ€ë‚¸ë‹¤ë©´ í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">SocialType</code>: Enumìœ¼ë¡œ OAuth2ì˜ ì œê³µìë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. (ex: KAKAO)</p>\n<p><code class=\"language-text\">AuthProvider</code>: ì‚¬ìš©ì ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì €í¬ì˜ ì—‘ì„¸ìŠ¤ í† í°ì„ ë§Œë“¤ì–´ ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">AuthExtractor</code>: ì—‘ì„¸ìŠ¤ í† í°ì„ íŒŒì‹±í•˜ì—¬ ìœ íš¨ì„±ì„ ê²€ì¦í•˜ê³  Payloadì˜ ê°’ì„ ì¶”ì¶œí•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">OAuth2Client</code>: OAuth2 ì¸ì¦, ë¦¬ì†ŒìŠ¤ ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ì—‘ì„¸ìŠ¤ í† í°, ì‚¬ìš©ì ì •ë³´ ë“± ë¯¼ê°í•œ ì •ë³´ë¥¼ ë°›ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">Member</code>: ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ì—”í‹°í‹°ë¡œ, <code class=\"language-text\">SocialType</code>ì„ í•„ë“œë¡œ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">AuthService</code>: ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ì„œë¹„ìŠ¤ ë ˆì´ì–´ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.</p>\n<p>ì—¬ê¸°ì„œ <code class=\"language-text\">OAuth2Client</code>ëŠ” ì™¸ë¶€ APIì— ì˜ì¡´í•˜ë¯€ë¡œ, ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸ë‚˜ ë¡œì»¬ í™˜ê²½ì—ì„œ ëª¨ì˜ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<h4>AuthProvider</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JwtAuthProvider</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AuthProvider</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">SECOND_FACTOR</span> <span class=\"token operator\">=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">MILLISECOND_FACTOR</span> <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">MEMBER_ID_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">;</span>\n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">SecretKey</span> key<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">long</span> expirationMinutes<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JwtAuthProvider</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> secretKey<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> expirationMinutes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> <span class=\"token class-name\">Keys</span><span class=\"token punctuation\">.</span><span class=\"token function\">hmacShaKeyFor</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span><span class=\"token constant\">UTF_8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>expirationMinutes <span class=\"token operator\">=</span> expirationMinutes<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">provide</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AuthPayload</span> authPayload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">Date</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Jwts</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">claim</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MEMBER_ID_KEY</span><span class=\"token punctuation\">,</span> authPayload<span class=\"token punctuation\">.</span><span class=\"token function\">getMemberId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   \n            <span class=\"token punctuation\">.</span><span class=\"token function\">setIssuedAt</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">setExpiration</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> expirationMinutes <span class=\"token operator\">*</span> <span class=\"token constant\">SECOND_FACTOR</span> <span class=\"token operator\">*</span> <span class=\"token constant\">MILLISECOND_FACTOR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">signWith</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SignatureAlgorithm</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HS256</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">compact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>AuthProviderì˜ êµ¬í˜„ì²´ì¸ <code class=\"language-text\">JwtAuthProvider</code> ì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">Member</code> ì—”í‹°í‹°ì˜ PKë¥¼ Payloadì— ë„£ì–´ JWT í† í°ì„ ë°˜í™˜í•´ ì¤ë‹ˆë‹¤.</p>\n<p>í•´ë‹¹ í† í°ì€ ì•ìœ¼ë¡œ ì €í¬ ì„œë²„ì— ì¸ì¦ ê³¼ì •ì— í•„ìš”í•œ ì—‘ì„¸ìŠ¤ í† í°ì…ë‹ˆë‹¤.</p>\n<h4>AuthExtractor</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JwtAuthExtractor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AuthExtractor</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">MEMBER_ID_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JwtParser</span> jwtParser<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">JwtAuthExtractor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> secretKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">SecretKey</span> key <span class=\"token operator\">=</span> <span class=\"token class-name\">Keys</span><span class=\"token punctuation\">.</span><span class=\"token function\">hmacShaKeyFor</span><span class=\"token punctuation\">(</span>secretKey<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StandardCharsets</span><span class=\"token punctuation\">.</span><span class=\"token constant\">UTF_8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtParser <span class=\"token operator\">=</span> <span class=\"token class-name\">Jwts</span><span class=\"token punctuation\">.</span><span class=\"token function\">parserBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">setSigningKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthPayload</span> <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">Claims</span> claims <span class=\"token operator\">=</span> <span class=\"token function\">getClaims</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">Long</span> memberId <span class=\"token operator\">=</span> claims<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MEMBER_ID_KEY</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthPayload</span><span class=\"token punctuation\">(</span>memberId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Claims</span> <span class=\"token function\">getClaims</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">return</span> jwtParser<span class=\"token punctuation\">.</span><span class=\"token function\">parseClaimsJws</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ExpiredJwtException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">EXPIRED_AUTH_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JwtException</span> <span class=\"token operator\">|</span> <span class=\"token class-name\">IllegalArgumentException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnauthorizedException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INVALID_AUTH_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>AuthExtractorì˜ êµ¬í˜„ì²´ì¸ <code class=\"language-text\">JwtAuthExtractor</code> ì…ë‹ˆë‹¤.</p>\n<p>í† í°ì„ ë°›ì•„ <code class=\"language-text\">AuthPayload</code> ê°ì²´ë¡œ ë§Œë“¤ì–´ ë°˜í™˜í•©ë‹ˆë‹¤.</p>\n<p>ì°¸ê³ ë¡œ í•„ë“œë¡œ <code class=\"language-text\">JwtParser</code>ë¥¼ ê°€ì§€ê³  ìˆëŠ”ë° ì´ëŠ” <code class=\"language-text\">Jwts.parserBuilder()</code> ë©”ì†Œë“œë¡œ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë¶ˆë³€í•˜ê³ , thread-safe í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/506e688f9113a93787b0ba4a5a32dff0/b9f8c/20230818023037.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 20.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVR42m2PWQ7DIAxEc56w2Kw2iVr1/peaGoL61Y8nhsWjx8GNUO6EpMW4wfoBtwYqwYgPlX7ZRw8fPJxzfzkozUFCEkUsRkqgHG0NC85h7WnvY7I7DvDeSk/3sMvOWSjs0A21h713yLig40bXC7cUvDTjPTKG0LJbw1YWzDJsW7/zPDtmmIXFCmtX1CboZttEUGsBMy07tl9wntlsOT6rwdM+70weX5WBfNTKQKa8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='20230818023037' title='' src='/static/506e688f9113a93787b0ba4a5a32dff0/ca1dc/20230818023037.png' srcset='/static/506e688f9113a93787b0ba4a5a32dff0/e7570/20230818023037.png 170w,\n/static/506e688f9113a93787b0ba4a5a32dff0/f46e7/20230818023037.png 340w,\n/static/506e688f9113a93787b0ba4a5a32dff0/ca1dc/20230818023037.png 680w,\n/static/506e688f9113a93787b0ba4a5a32dff0/b9f8c/20230818023037.png 854w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ íŒŒì‹±í•  ë•Œë§ˆë‹¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒˆë¡­ê²Œ ë§Œë“¤ì§€ ì•Šê³ , ê¸°ì¡´ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// íŒŒì‹±ë§ˆë‹¤ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</span>\n<span class=\"token keyword\">return</span> <span class=\"token class-name\">Jwts</span><span class=\"token punctuation\">.</span><span class=\"token function\">parserBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">setSigningKey</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">parseClaimsJws</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// íŒŒì‹±ë§ˆë‹¤ ê¸°ì¡´ì˜ ì¸ìŠ¤í„´ìŠ¤ ì¬ì‚¬ìš©</span>\n<span class=\"token keyword\">return</span> jwtParser<span class=\"token punctuation\">.</span><span class=\"token function\">parseClaimsJws</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<h4>OAuth2Client</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2Client</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OAuth2Client</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ACCESS_TOKEN_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kauth.kakao.com/oauth/token\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">USER_INFO_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kapi.kakao.com/v2/user/me\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">RestTemplate</span> restTemplate<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> redirectId<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2Client</span><span class=\"token punctuation\">(</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.grant-type}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.client-id}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.redirect-uri}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> redirectUri<span class=\"token punctuation\">,</span>  \n        <span class=\"token class-name\">RestTemplateBuilder</span> restTemplateBuilder  \n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>grantType <span class=\"token operator\">=</span> grantType<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>clientId <span class=\"token operator\">=</span> clientId<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redirectId <span class=\"token operator\">=</span> redirectUri<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restTemplate <span class=\"token operator\">=</span> restTemplateBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"grant_type\"</span><span class=\"token punctuation\">,</span> grantType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_id\"</span><span class=\"token punctuation\">,</span> clientId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"redirect_uri\"</span><span class=\"token punctuation\">,</span> redirectId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"code\"</span><span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoAccessTokenResponse</span> response <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span>  \n                <span class=\"token constant\">ACCESS_TOKEN_URL</span><span class=\"token punctuation\">,</span> headers<span class=\"token punctuation\">,</span>  \n                <span class=\"token class-name\">KakaoAccessTokenResponse</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">accessToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpClientErrorException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoOAuth2Error</span> kakaoOAuth2Error <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getResponseBodyAs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2Error</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>kakaoOAuth2Error<span class=\"token punctuation\">.</span><span class=\"token function\">isErrorCodeKOE320</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_INVALID_CODE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token punctuation\">}</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setBearerAuth</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoUserInfo</span> kakaoUserInfo <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span><span class=\"token constant\">USER_INFO_URL</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  \n                    <span class=\"token class-name\">KakaoUserInfo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofKakao</span><span class=\"token punctuation\">(</span>kakaoUserInfo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpClientErrorException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">KakaoOAuth2Error</span><span class=\"token punctuation\">(</span>  \n        <span class=\"token class-name\">String</span> error<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error_description\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> errorDescription<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error_code\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> errorCode  \n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  \n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isErrorCodeKOE320</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">return</span> errorCode<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"KOE320\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì‹¤ì œ ì¹´ì¹´ì˜¤ OAuth2 ì„œë¹„ìŠ¤ ì œê³µìì—ê²Œ ì •ë³´ë¥¼ ìš”ì²­í•˜ëŠ” <code class=\"language-text\">KakaoOAuth2Client</code> ì…ë‹ˆë‹¤.</p>\n<p>ì½”ë“œì— ì§€ì €ë¶„í•œ ê³³ì´ ë§ê³ , ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì§€í‚¤ì§€ ì•ŠëŠ” ë¶€ë¶„ì´ ìˆìŠµë‹ˆë‹¤. (ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­, ì‚¬ìš©ì ì •ë³´ ìš”ì²­)</p>\n<p>ì¶”í›„ ì´ ë¶€ë¶„ì„ ì–´ë–»ê²Œ ê°œì„ í–ˆëŠ”ì§€ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>recordì— @JsonPropertyë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ” <a href=\"https://stackoverflow.com/questions/68394911/why-record-class-cant-be-properly-deserialized-with-jackson\">ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš° ë§í¬</a>ì— ë‚˜ì™€ ìˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<h4>AuthService</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuth2Client</span> oAuth2Client<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AuthProvider</span> authProvider<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">,</span> <span class=\"token class-name\">OAuth2Client</span> oAuth2Client<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AuthProvider</span> authProvider<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>memberRepository <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oAuth2Client <span class=\"token operator\">=</span> oAuth2Client<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authProvider <span class=\"token operator\">=</span> authProvider<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginResponse</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">String</span> accessToken <span class=\"token operator\">=</span> oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">UserInfo</span> userInfo <span class=\"token operator\">=</span> oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findBySocialIdAndSocialType</span><span class=\"token punctuation\">(</span>userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">socialId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">socialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">toMember</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginResponse</span><span class=\"token punctuation\">(</span>authProvider<span class=\"token punctuation\">.</span><span class=\"token function\">provide</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">nickname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë³´ë‚´ì˜¨ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.</p>\n<p>íë¦„ì€ ë§¨ ìœ„ì—ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ê°™ì´ ì½”ë“œë¥¼ ë°›ì•„, OAuth2 ì„œë¹„ìŠ¤ ì œê³µìë¡œë¶€í„° ì•¡ì„¸ìŠ¤ í† í°ì„ ì–»ê³ , ì‚¬ìš©ì ì •ë³´ë¥¼ ì–»ì€ ë’¤ ê¸°ì¡´ì˜ íšŒì›ì´ ìˆìœ¼ë©´ <code class=\"language-text\">AuthProvider</code>ë¥¼ í†µí•´ ì•¡ì„¸ìŠ¤ í† í°ì„ ë°˜í™˜í•˜ê³ , ê¸°ì¡´ì˜ íšŒì›ì´ ì—†ë‹¤ë©´ <code class=\"language-text\">orElseGet()</code> ë©”ì„œë“œë¥¼ í†µí•´ íšŒì›ì„ ìƒì„±í•˜ê³  ì•¡ì„¸ìŠ¤ í† í°ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p>\n<hr>\n<p>ì´ë ‡ê²Œ êµ¬í˜„í•œ ë°©ì‹ì—ëŠ” ë¬¸ì œì ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">OAuth2Client</code>ì˜ ì½”ë“œë¥¼ ë³´ë©´ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì§€í‚¤ì§€ ëª»í–ˆê³ (ì•¡ì„¸ìŠ¤ ì½”ë“œì™€ ì‚¬ìš©ì ì •ë³´ë¥¼ ëª¨ë‘ ê´€ë¦¬) ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ try-catchë¬¸ ë•Œë¬¸ì— ì½”ë“œì˜ ê°€ë…ì„±ì´ ë‚˜ì©ë‹ˆë‹¤.</p>\n<p>ê·¸ë¦¬ê³  <code class=\"language-text\">OAuth2Client</code>ë¥¼ ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜í•˜ì—¬ ë³€ê²½ì—ëŠ” ìœ ì—°í•˜ê²Œ ëŒ€ì‘í–ˆì§€ë§Œ, ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì´ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ OAuth2 ì„œë¹„ìŠ¤ ì œê³µìê°€ ì¶”ê°€ë  ê²½ìš° ìƒˆë¡œìš´ í´ë˜ìŠ¤ í˜¹ì€ ë©”ì†Œë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<h3>ë‹¨ì¼ ì±…ì„ ì›ì¹™ì˜ ë¶„ë¦¬</h3>\n<p>ìœ ëª…í•œ ê°ì²´ ì§€í–¥ ì›ì¹™ì¸ SOLID ì›ì¹™ì—ì„œ SëŠ” ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ëœ»í•©ë‹ˆë‹¤.</p>\n<p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©°, ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•œ OCP, DIP ì›ì¹™ì€ ë§¤ìš° ì‰½ê²Œ ì§€í‚¬ ìˆ˜ ìˆìœ¼ë‚˜, SRP ì›ì¹™ì€ êµ¬í˜„í•˜ëŠ” ê°œë°œìê°€ ê°ì²´ê°€ ê°€ì§€ëŠ” ì±…ì„ì„ ì–¼ë§ˆë‚˜ ì˜ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ”ì§€ì— ë”°ë¼ ë‹¬ë ¸ìŠµë‹ˆë‹¤.</p>\n<p>OAuth2ClientëŠ” ë‘ ê°€ì§€ ì¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p>\n<ol>\n<li>ì•¡ì„¸ìŠ¤ í† í°ì„ ìš”ì²­</li>\n<li>ì‚¬ìš©ì ì •ë³´ë¥¼ ìš”ì²­</li>\n</ol>\n<p>ë‘ ê°€ì§€ ì¼ì€ OAuth2 ì¸ì¦ì˜ íë¦„ìœ¼ë¡œëŠ” í•˜ë‚˜ì˜ ì‘ì—…ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆê² ì§€ë§Œ ê°ì²´ê°€ ê°€ì§€ëŠ” ì±…ì„ì€ ë‘ ê°€ì§€ ì±…ì„ì„ ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ, ì—‘ì„¸ìŠ¤ í† í°ë§Œ ìš”ì²­í•˜ëŠ” í´ë˜ìŠ¤ì™€ ì‚¬ìš©ì ì •ë³´ë§Œ ìš”ì²­í•˜ëŠ” í´ë˜ìŠ¤ë¡œ ë‚˜ëˆ  ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h4>KakaoOAuth2AccessTokenClient</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kauth.kakao.com/oauth/token\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">RestTemplate</span> restTemplate<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> redirectUri<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span><span class=\"token punctuation\">(</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.grant-type}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.client-id}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.redirect-uri}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> redirectUri<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.client-secret}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> clientSecret<span class=\"token punctuation\">,</span>  \n        <span class=\"token class-name\">RestTemplateBuilder</span> restTemplateBuilder  \n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>grantType <span class=\"token operator\">=</span> grantType<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>clientId <span class=\"token operator\">=</span> clientId<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redirectUri <span class=\"token operator\">=</span> redirectUri<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>clientSecret <span class=\"token operator\">=</span> clientSecret<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restTemplate <span class=\"token operator\">=</span> restTemplateBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token function\">getAccessTokenHeaders</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token function\">requestAccessToken</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HttpHeaders</span> <span class=\"token function\">getAccessTokenHeaders</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"grant_type\"</span><span class=\"token punctuation\">,</span> grantType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_id\"</span><span class=\"token punctuation\">,</span> clientId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"redirect_uri\"</span><span class=\"token punctuation\">,</span> redirectUri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_secret\"</span><span class=\"token punctuation\">,</span> clientSecret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"code\"</span><span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> headers<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">requestAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoAccessTokenResponse</span> response <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ACCESS_TOKEN_URL</span><span class=\"token punctuation\">,</span> headers<span class=\"token punctuation\">,</span>  \n                <span class=\"token class-name\">KakaoAccessTokenResponse</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">accessToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpClientErrorException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoOAuth2Error</span> kakaoOAuth2Error <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getResponseBodyAs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2Error</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>kakaoOAuth2Error<span class=\"token punctuation\">.</span><span class=\"token function\">isErrorCodeKOE320</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_INVALID_CODE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token punctuation\">}</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>KakaoOAuth2UserInfoClient</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kapi.kakao.com/v2/user/me\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">RestTemplate</span> restTemplate<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RestTemplateBuilder</span> restTemplateBuilder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restTemplate <span class=\"token operator\">=</span> restTemplateBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token function\">getUserInfoHeaders</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token function\">requestUserInfo</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HttpHeaders</span> <span class=\"token function\">getUserInfoHeaders</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setBearerAuth</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> headers<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">requestUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoUserInfo</span> kakaoUserInfo <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span><span class=\"token constant\">USER_INFO_URL</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  \n                    <span class=\"token class-name\">KakaoUserInfo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token keyword\">return</span> kakaoUserInfo<span class=\"token punctuation\">.</span><span class=\"token function\">toUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpClientErrorException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë¦¬ê³  ê¸°ì¡´ì˜ <code class=\"language-text\">KakaoOAuth2Client</code>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2Client</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OAuth2Client</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span> accessTokenClient<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span> userInfoClient<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2Client</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span> accessTokenClient<span class=\"token punctuation\">,</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span> userInfoClient<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accessTokenClient <span class=\"token operator\">=</span> accessTokenClient<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>userInfoClient <span class=\"token operator\">=</span> userInfoClient<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> accessTokenClient<span class=\"token punctuation\">.</span><span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> userInfoClient<span class=\"token punctuation\">.</span><span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì œë¶€í„° <code class=\"language-text\">KakaoOAuth2Client</code> í´ë˜ìŠ¤ëŠ” ì±…ì„ì„ ë¶„ë¦¬í•œ í´ë˜ìŠ¤ì— ìš”ì²­ì„ ìœ„ì„í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>\n<h4>ResponseErrorHandler</h4>\n<p>í•˜ì§€ë§Œ ì•„ì§ë„ ì—¬ì „íˆ ì¶”í•œ try-catchê°€ ì½”ë“œì— ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">RestTemplate</code> í´ë˜ìŠ¤ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì–´ì©” ìˆ˜ ì—†ì´ try-catchë¬¸ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ì ê¹,</p>\n<p>ì €í¬ëŠ” ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë©° ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— try-catchë¥¼ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>\n<p>ì˜¤íˆë ¤ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šê³  ë˜ì ¸ë²„ë¦½ë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ¬ëŠ” ì´ìœ ëŠ” ìš”ì²­ì˜ ì˜ˆì™¸ë¥¼ ì „ì—­ì ìœ¼ë¡œ ì²˜ë¦¬í•´ ì£¼ëŠ” <code class=\"language-text\">@ControllerAdvice</code>ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">RestTemplate</code> í´ë˜ìŠ¤ì—ì„œë„ <code class=\"language-text\">@ControllerAdvice</code> ê°™ì€ ì—­í• ì„ í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë°”ë¡œ <code class=\"language-text\">ResponseErrorHandler</code> ì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">ResponseErrorHandler</code>ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°œì˜ ì¶”ìƒ ë©”ì†Œë“œë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ResponseErrorHandler</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">boolean</span> <span class=\"token function\">hasError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClientHttpResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">void</span> <span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClientHttpResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì‚¬ì‹¤ ì´ë¯¸ <code class=\"language-text\">RestTemplate</code>ì—ì„œëŠ” ê¸°ë³¸ì ì¸ <code class=\"language-text\">ResponseErrorHandler</code>ê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RestTemplate</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">InterceptingHttpAccessor</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">RestOperations</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ResponseErrorHandler</span> errorHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultResponseErrorHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë”°ë¼ì„œ ê¸°ì¡´ì˜ <code class=\"language-text\">ResponseErrorHandler</code>ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì»¤ìŠ¤í…€í•œ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë©´ ì˜ˆì™¸ ì²˜ë¦¬ì— ê´€í•œ ë¡œì§ì„ ë¶„ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h4>KakaoOAuth2AccessTokenErrorHandler</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenErrorHandler</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">DefaultResponseErrorHandler</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClientHttpResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatusCodeException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">HttpStatusCode</span> statusCode <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">getStatusCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token function\">handle4xxError</span><span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token function\">handle5xxError</span><span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle4xxError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatusCode</span> statusCode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpStatusCodeException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">.</span><span class=\"token function\">is4xxClientError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token class-name\">KakaoOAuth2ErrorResponse</span> errorResponse <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getResponseBodyAs</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2ErrorResponse</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            <span class=\"token function\">handleErrorCode</span><span class=\"token punctuation\">(</span>errorResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleErrorCode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2ErrorResponse</span> errorResponse<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token function\">handleKOE320Error</span><span class=\"token punctuation\">(</span>errorResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_INVALID_REQUEST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleKOE320Error</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">KakaoOAuth2ErrorResponse</span> errorResponse<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>errorResponse <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> errorResponse<span class=\"token punctuation\">.</span><span class=\"token function\">isErrorCodeKOE320</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_INVALID_CODE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle5xxError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatusCode</span> statusCode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">.</span><span class=\"token function\">is5xxServerError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_PROVIDER_NOT_RESPONSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">KakaoOAuth2ErrorResponse</span><span class=\"token punctuation\">(</span>  \n        <span class=\"token class-name\">String</span> error<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error_description\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> errorDescription<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@JsonProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error_code\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> errorCode  \n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  \n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isErrorCodeKOE320</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">Objects</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>errorCode<span class=\"token punctuation\">,</span> <span class=\"token string\">\"KOE320\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>KakaoOAuth2UserInfoErrorHandler</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2UserInfoErrorHandler</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">DefaultResponseErrorHandler</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClientHttpResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpStatusCode</span> statusCode <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">getStatusCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token function\">handle4xxError</span><span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token function\">handle5xxError</span><span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle4xxError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatusCode</span> statusCode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">.</span><span class=\"token function\">is4xxClientError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_INVALID_REQUEST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle5xxError</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatusCode</span> statusCode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>statusCode<span class=\"token punctuation\">.</span><span class=\"token function\">is5xxServerError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InternalServerException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ErrorCode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OAUTH2_PROVIDER_NOT_RESPONSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•´ë‹¹ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¥¼ ì ìš©í•œ OAuth2ClientëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œê°€ ë³€ê²½ë©ë‹ˆë‹¤.</p>\n<h4>KakaoOAuth2AccessTokenClient</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kauth.kakao.com/oauth/token\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">RestTemplate</span> restTemplate<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> redirectUri<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenClient</span><span class=\"token punctuation\">(</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.grant-type}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> grantType<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.client-id}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> clientId<span class=\"token punctuation\">,</span>  \n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.redirect-uri}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> redirectUri<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${festago.oauth2.kakao.client-secret}\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> clientSecret<span class=\"token punctuation\">,</span>  \n        <span class=\"token class-name\">RestTemplateBuilder</span> restTemplateBuilder  \n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>grantType <span class=\"token operator\">=</span> grantType<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>clientId <span class=\"token operator\">=</span> clientId<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redirectUri <span class=\"token operator\">=</span> redirectUri<span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>clientSecret <span class=\"token operator\">=</span> clientSecret<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restTemplate <span class=\"token operator\">=</span> restTemplateBuilder\n            <span class=\"token punctuation\">.</span><span class=\"token function\">errorHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">KakaoOAuth2AccessTokenErrorHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token function\">getAccessTokenHeaders</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token function\">requestAccessToken</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HttpHeaders</span> <span class=\"token function\">getAccessTokenHeaders</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"grant_type\"</span><span class=\"token punctuation\">,</span> grantType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_id\"</span><span class=\"token punctuation\">,</span> clientId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"redirect_uri\"</span><span class=\"token punctuation\">,</span> redirectUri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_secret\"</span><span class=\"token punctuation\">,</span> clientSecret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"code\"</span><span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> headers<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">requestAccessToken</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">KakaoAccessTokenResponse</span> response <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ACCESS_TOKEN_URL</span><span class=\"token punctuation\">,</span> headers<span class=\"token punctuation\">,</span>  \n            <span class=\"token class-name\">KakaoAccessTokenResponse</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">accessToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>KakaoOAuth2UserInfoClient</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://kapi.kakao.com/v2/user/me\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">RestTemplate</span> restTemplate<span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">KakaoOAuth2UserInfoClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RestTemplateBuilder</span> restTemplateBuilder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>restTemplate <span class=\"token operator\">=</span> restTemplateBuilder\n            <span class=\"token punctuation\">.</span><span class=\"token function\">errorHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">KakaoOAuth2UserInfoErrorHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token function\">getUserInfoHeaders</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token function\">requestUserInfo</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">HttpHeaders</span> <span class=\"token function\">getUserInfoHeaders</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">HttpHeaders</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_FORM_URLENCODED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        headers<span class=\"token punctuation\">.</span><span class=\"token function\">setBearerAuth</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> headers<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">requestUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpHeaders</span> headers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">KakaoUserInfo</span> kakaoUserInfo <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">postForEntity</span><span class=\"token punctuation\">(</span><span class=\"token constant\">USER_INFO_URL</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  \n                <span class=\"token class-name\">KakaoUserInfo</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> kakaoUserInfo<span class=\"token punctuation\">.</span><span class=\"token function\">toUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì²˜ëŸ¼ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬, ìš”ì²­ì„ ë³´ë‚´ëŠ” ê°ì²´ì—ëŠ” ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œ í•˜ë‚˜ ì—†ì´ ì˜¤ë¡œì§€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ë‚¨ê²Œ ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h3>ìƒˆë¡œìš´ OAuth2 í´ë¼ì´ì–¸íŠ¸ì˜ ì¶”ê°€</h3>\n<p>ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” <code class=\"language-text\">OAuth2Client</code>ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.</p>\n<p>ì¸í„°í˜ì´ìŠ¤ë¡œ ì„¤ê³„í•˜ì—¬, OAuth2 ì„œë¹„ìŠ¤ ì œê³µìê°€ ë°”ë€Œë”ë¼ë„ ì‰½ê²Œ êµì²´í•  ìˆ˜ ìˆê³ , ëª¨ì˜ OAuth2Client ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸í•  ë•Œ ì™¸ë¶€ APIì˜ ì—°ë™ ì—†ì´ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ ì´ë ‡ê²Œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë§Œë“¤ì–´ë„, ì¸ìŠ¤í„´ìŠ¤ì˜ í•„ë“œê°€ í•˜ë‚˜ì´ê¸° ë•Œë¬¸ì— ì¶”ê°€ì ì¸ OAuth2Clientë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„œë¹„ìŠ¤ ì œê³µìë§ˆë‹¤ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê±°ë‚˜, í•„ë“œì™€ ë©”ì†Œë“œê°€ ìƒê¸¸ ê²ƒì…ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KakaoOAuth2Service</span><span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NaverOAuth2Service</span><span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ë˜ëŠ”</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuth2Client</span> kakaoOAuth2Client<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuth2Client</span> naverOAuth2Client<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">loginKakaoOAuth2</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">loginKakaoOAuth2</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ê²ƒì€ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì§€ì¼°ë‹¤ê³  í•  ìˆ˜ ìˆê² ì§€ë§Œ, ì¤‘ë³µëœ ì½”ë“œê°€ ìƒê¸°ê²Œ ë˜ê³  ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì œê³µìê°€ ìƒê¸¸ ë•Œ ìƒˆë¡œìš´ ë©”ì†Œë“œë¥¼ ì¶”ê°€í•´ ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ì˜ í•„ë“œë¡œ ì—¬ëŸ¬ <code class=\"language-text\">OAuth2Client</code>ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>\n<p>ìŠ¤í”„ë§ì€ ì˜ì¡´ì„±ì„ ì£¼ì…í•  ë•Œ ì»¬ë ‰ì…˜ìœ¼ë¡œ ì˜ì¡´ì„±ì„ ì£¼ì…í•´ ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì—¬ëŸ¬ <code class=\"language-text\">OAuth2Client</code>ë¥¼ <code class=\"language-text\">List</code> í˜•ì‹ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2Clients<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2Clients<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oAuth2Clients <span class=\"token operator\">=</span> oAuth2Clients<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ê²ƒì´ ë°”ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì˜ì¡´í•˜ê²Œ í•˜ë©´ ì–»ì„ ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ì´ì  ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ°ë°, ë‹¨ìˆœíˆ List íƒ€ì…ìœ¼ë¡œ ë°›ì•˜ë‹¤ê³  í•´ì„œ ëë‚˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.</p>\n<p>ë¦¬ìŠ¤íŠ¸ ì¤‘ì—ì„œ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ ì œê³µìë¥¼ ì„ íƒí•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">OAuth2Client</span> <span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span> socialType<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> oAuth2Clients<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>client <span class=\"token operator\">-></span> client<span class=\"token punctuation\">.</span>getSocialType <span class=\"token operator\">==</span> socialType<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ë ‡ê²Œ Streamì„ í™œìš©í•´ì„œ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ ì œê³µìë¥¼ ì„ íƒí•  ìˆ˜ ìˆê² ì§€ë§Œ, ë§¤ë²ˆ Streamì„ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ ì œê³µìë¥¼ ì°¾ëŠ” ì‘ì—…ì€ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.</p>\n<p>ì´ë•ŒëŠ” List ìë£Œêµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë³´ë‹¤ Map ìë£Œêµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ë©´ íš¨ìœ¨ì ì¼ ê²ƒì…ë‹ˆë‹¤.</p>\n<p>ìŠ¤í”„ë§ì€ Map íƒ€ì…ìœ¼ë¡œë„ ì˜ì¡´ì„± ì£¼ì…ì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ Mapìœ¼ë¡œ ì˜ì¡´ì„±ì„ ì£¼ì…ë°›ìœ¼ë©´ Keyê°€ Stringì¸ <code class=\"language-text\">kakaoOAuth2Client</code>ì™€ ê°™ì´ ì§€ì •ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2ClientMap<span class=\"token punctuation\">;</span></code></pre></div>\n<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì˜ì¡´ì„± ì£¼ì…ì€ Listë¡œ ë°›ì€ ë’¤, ë‚´ë¶€ì—ì„œ Mapìœ¼ë¡œ ë³€í™˜ì‹œí‚¤ë©´ Keyê°€ Enum íƒ€ì…ì¸ Mapì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SocialType</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2ClientMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EnumMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">AuthService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2Clients<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">OAuth2Client</span> oAuth2Client<span class=\"token operator\">:</span> oAuth2Clients<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        oAuth2ClientMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> oAuth2Client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ì œ ë‹¤ìŒê³¼ ê°™ì´ íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ë¥¼ ë¹ ë¥´ê²Œ ì°¾ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">OAuth2Clients</span> <span class=\"token function\">getOAuth2Client</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span> socialType<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>oAuth2ClientMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>socialType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n        <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì´ê²ƒ ë˜í•œ ì™„ë²½í•˜ê²Œ í•´ê²°í•œ ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.</p>\n<p>í•„ë“œì— <code class=\"language-text\">OAuth2Client</code>ì— ëŒ€í•œ ìë£Œêµ¬ì¡°ê°€ ê·¸ëŒ€ë¡œ ë…¸ì¶œì´ ë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">AuthService</code> í´ë˜ìŠ¤ì—ì„œ í•„ìš”í•œ ê¸°ëŠ¥ì€ SocialTypeì— ë§ëŠ” OAuth2Clientë§Œ ì„ íƒí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">AuthService</code> í´ë˜ìŠ¤ëŠ” Mapì— ëŒ€í•œ ê¸°ëŠ¥ì„ ìì„¸íˆ ì•Œ í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.</p>\n<p>ì´ê²ƒì€ ì €í¬ê°€ ë ˆë²¨1ë¶€í„° ë°°ì›Œì˜¨ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ë°”ë¡œ <code class=\"language-text\">ì¼ê¸‰ ì»¬ë ‰ì…˜</code>ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OAuth2Clients</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SocialType</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2ClientMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EnumMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">OAuth2Clients</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OAuth2Client</span><span class=\"token punctuation\">></span></span> oAuth2Clients<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">OAuth2Client</span> oAuth2Client<span class=\"token operator\">:</span> oAuth2Clients<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            oAuth2ClientMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> oAuth2Client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">OAuth2Client</span> <span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span> socialType<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>oAuth2ClientMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>socialType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ê·¸ë¦¬ê³  <code class=\"language-text\">AuthService</code>ì˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë³€í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OAuth2Clients</span> oAuth2Clients<span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LoginResponse</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SocialType</span> socialType<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token class-name\">OAuth2Client</span> oAuth2Client <span class=\"token operator\">=</span> oAuth2Clients<span class=\"token punctuation\">.</span><span class=\"token function\">getClient</span><span class=\"token punctuation\">(</span>socialType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> accessToken <span class=\"token operator\">=</span> oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getAccessToken</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">UserInfo</span> userInfo <span class=\"token operator\">=</span> oAuth2Client<span class=\"token punctuation\">.</span><span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findBySocialIdAndSocialType</span><span class=\"token punctuation\">(</span>userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">socialId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> socialType<span class=\"token punctuation\">)</span>  \n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">toMember</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoginResponse</span><span class=\"token punctuation\">(</span>authProvider<span class=\"token punctuation\">.</span><span class=\"token function\">provide</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> userInfo<span class=\"token punctuation\">.</span><span class=\"token function\">nickname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span> </code></pre></div>\n<p>ì´ì œ ìƒˆë¡œìš´ OAuth2Clientê°€ ì¶”ê°€ë˜ì–´ë„ ê¸°ì¡´ì˜ ì½”ë“œë¥¼ ë³€ê²½í•  í•„ìš”ëŠ” ì „í˜€ ì—†ì–´ì§‘ë‹ˆë‹¤.</p>\n<p>ë˜í•œ ë¡œì»¬ í™˜ê²½ ë˜ëŠ” í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ìœ„í•œ ëª¨ì˜ OAuth2Clientë¥¼ ë§Œë“¤ë”ë¼ë„ <code class=\"language-text\">@Profile</code>  ì–´ë…¸í…Œì´ì…˜ì˜ ì‚¬ìš©ìœ¼ë¡œ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì „í˜€ ì˜í–¥ì„ ì£¼ì§€ ì•Šê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>  \n<span class=\"token annotation punctuation\">@Profile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"!prod\"</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FestagoOAuth2Client</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OAuth2Client</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">PROFILE_IMAGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://placehold.co/150x150\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">></span></span> userInfoMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">FestagoOAuth2Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        userInfoMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member1\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">PROFILE_IMAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        userInfoMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member2\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">PROFILE_IMAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        userInfoMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"member3\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">PROFILE_IMAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">UserInfo</span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> accessToken<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">ofNullable</span><span class=\"token punctuation\">(</span>userInfoMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BadRequestException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>  \n  \n    <span class=\"token annotation punctuation\">@Override</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SocialType</span> <span class=\"token function\">getSocialType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">SocialType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">FESTAGO</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>ê²°ë¡ </h2>\n<p>OAuth2ë¥¼ ì‚¬ìš©í•œ ì¸ì¦ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ë•Œ, ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ì˜ì¡´ì„± ì£¼ì… ê¸°ëŠ¥ê³¼ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë‹¤í˜•ì„± í™œìš© ë“±, ê°ì²´ ì§€í–¥ ì„¤ê³„ë¥¼ ë”°ë¼ ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©´ ë³€ê²½ì— ìœ ì—°í•˜ê³  ê°€ë…ì„±ì´ ë†’ì€ ì½”ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì €í¬ ì„œë¹„ìŠ¤ íŠ¹ì„±ìƒ ìƒˆë¡œìš´ OAuth2 ì„œë¹„ìŠ¤ ì œê³µìê°€ ì¶”ê°€ë  í™•ë¥ ì€ ë‚®ê² ì§€ë§Œ, ë ˆë²¨ 1, 2 ê³¼ì •ì„ ë°°ìš°ë©° ìŠµë“í•œ ê°ì²´ ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì´ë ‡ê²Œ ì„œë¹„ìŠ¤ì— ë…¹ì—¬ëƒˆë‹¤ëŠ” ì ì´ ë¿Œë“¯í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>","frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - OAuth2ë¥¼ ì„ íƒí•˜ê³  ì ìš©í•œ ë°©ë²•","date":"August 20, 2023","update":"August 20, 2023","tags":["OAuth2"],"series":null},"fields":{"slug":"/oauth2-select-and-apply/","readingTime":{"minutes":21.65}}},"seriesList":{"edges":[{"node":{"id":"9ecb7f42-84ec-536a-9bfc-a3affcb87512","fields":{"slug":"/oauth2-select-and-apply/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - OAuth2ë¥¼ ì„ íƒí•˜ê³  ì ìš©í•œ ë°©ë²•"}}},{"node":{"id":"1c28c731-cebd-5aab-b9bd-a5c397bf9c7a","fields":{"slug":"/oauth2-multiple-user-auth/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ì¸ì¦ê³¼ ì¸ê°€"}}},{"node":{"id":"b2e904f3-69c7-5c99-96e7-9555aaddc0e2","fields":{"slug":"/concurrency-redis/"},"frontmatter":{"title":"ì„ ì°©ìˆœ í‹°ì¼“íŒ…ì— Redis ë„ì…í•˜ê¸°"}}},{"node":{"id":"337eca9e-cd03-5e90-9d8f-d0b86e0ce4b9","fields":{"slug":"/facade-service/"},"frontmatter":{"title":"Facade ê°ì²´ë¥¼ í™œìš©í•´ íŠ¸ëœì­ì…˜ì—ì„œ ì™¸ë¶€ API í†µì‹  ë¶„ë¦¬í•˜ê¸°"}}},{"node":{"id":"9ef33612-c159-552c-ba72-40903662c51c","fields":{"slug":"/event-singlelivedata/"},"frontmatter":{"title":"LiveDataë¡œ ì´ë²¤íŠ¸ ì²˜ë¦¬í•˜ê¸°: SingleLiveData"}}},{"node":{"id":"efd29a38-290b-5064-a87e-65f3d5ea4643","fields":{"slug":"/livedata-to-flow/"},"frontmatter":{"title":"Refactoring LiveData to Flow"}}}]},"previous":null,"next":{"fields":{"slug":"/oauth2-multiple-user-auth/"},"frontmatter":{"title":"í˜ìŠ¤íƒ€ê³ ì˜ ì¸ì¦ - ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ì¸ì¦ê³¼ ì¸ê°€"}}},"pageContext":{"id":"9ecb7f42-84ec-536a-9bfc-a3affcb87512","series":null,"previousPostId":null,"nextPostId":"1c28c731-cebd-5aab-b9bd-a5c397bf9c7a"}},"staticQueryHashes":[],"slicesMap":{}}